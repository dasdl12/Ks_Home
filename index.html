<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>金山云企业文化窗口</title>
    <!-- 引入统一Header组件样式 -->
    <link rel="stylesheet" href="components/header.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --ks-red: #E60012;
            --ks-dark: #1A1A1A;
            --ks-gray: #666666;
            --ks-light-gray: #F5F5F5;
            --ks-white: #FFFFFF;
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Microsoft YaHei", sans-serif;
            line-height: 1.6;
            color: var(--ks-dark);
            background: #FAFAFA;
            position: relative;
            overflow-x: hidden;
        }

        /* Background Decoration */
        body::before {
            content: '';
            position: fixed;
            top: -50%;
            right: -20%;
            width: 80%;
            height: 80%;
            background: radial-gradient(circle, rgba(230, 0, 18, 0.03) 0%, transparent 70%);
            border-radius: 50%;
            pointer-events: none;
            z-index: -1;
        }

        body::after {
            content: '';
            position: fixed;
            bottom: -30%;
            left: -10%;
            width: 60%;
            height: 60%;
            background: linear-gradient(135deg, rgba(230, 0, 18, 0.02) 0%, transparent 60%);
            transform: rotate(45deg);
            pointer-events: none;
            z-index: -1;
        }

        .bg-pattern {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0.02;
            background-image: 
                repeating-linear-gradient(45deg, transparent, transparent 35px, rgba(230, 0, 18, 0.5) 35px, rgba(230, 0, 18, 0.5) 70px),
                repeating-linear-gradient(-45deg, transparent, transparent 35px, rgba(230, 0, 18, 0.3) 35px, rgba(230, 0, 18, 0.3) 70px);
            pointer-events: none;
            z-index: -1;
        }

        /* Main Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px;
            position: relative;
            z-index: 1;
        }

        /* Main Layout */
        .top-section {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 24px;
            margin-bottom: 24px;
        }

        /* Banner Section with Thumbnail Navigation */
        .banner-carousel {
            position: relative;
            height: 300px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow-md);
            display: flex;
            background: #000;
            z-index: 1; /* 设置banner的z-index，低于小kk(3) */
        }

        .banner-main {
            width: 80%;
            height: 100%;
            position: relative;
            overflow: hidden;
        }

        .banner-slides {
            display: flex;
            height: 100%;
            transition: transform 0.5s ease;
        }

        .banner-slide {
            min-width: 100%;
            height: 100%;
            position: relative;
        }

        .banner-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Banner标题层样式 */
        .banner-slide-title {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 20px 30px;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0.4) 50%, transparent 100%);
            color: white;
            font-size: 20px;
            font-weight: 600;
            letter-spacing: 0.5px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            opacity: 0.95;
            transition: all 0.3s ease;
        }

        .banner-slide-title:hover {
            opacity: 1;
            padding-bottom: 24px;
        }

        .banner-thumbnails {
            width: 20%;
            height: 100%;
            background: rgba(26, 26, 26, 0.95);
            display: flex;
            flex-direction: column;
            padding: 10px;
            gap: 10px;
            overflow-y: auto;
        }

        .thumbnail-item {
            position: relative;
            flex: 1;
            min-height: 60px;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            opacity: 0.6;
            border: 2px solid transparent;
        }

        .thumbnail-item:hover {
            opacity: 1;
            transform: scale(1.05);
        }

        .thumbnail-item.active {
            opacity: 1;
            border-color: var(--ks-red);
            box-shadow: 0 0 0 1px var(--ks-red);
        }

        .thumbnail-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .thumbnail-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.8) 0%, transparent 100%);
            padding: 8px;
            color: white;
            font-size: 11px;
            font-weight: 500;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .thumbnail-item:hover .thumbnail-overlay {
            opacity: 1;
        }

        /* User Info Module - Match Banner Height */
        .user-info-module {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: var(--shadow-sm);
            height: 300px;
            display: flex;
            flex-direction: column;
        }

        .user-info-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 16px;
            padding-bottom: 16px;
            border-bottom: 1px solid #F0F0F0;
        }

        .user-avatar-large {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-image: url('cd4bd41dc215915e39fa6964ce208923.jpg');
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .user-level-badge {
            position: absolute;
            bottom: -4px;
            right: -4px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: white;
            font-size: 11px;
            font-weight: bold;
            padding: 2px 8px;
            border-radius: 12px;
            border: 2px solid white;
        }

        .user-details {
            flex: 1;
        }

        .user-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .user-department {
            font-size: 13px;
            color: var(--ks-gray);
        }

        .date-info {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            text-align: right;
            margin-left: auto;
        }

        .date-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 4px;
        }

        .current-weekday {
            font-size: 14px;
            font-weight: 600;
            color: var(--ks-dark);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Microsoft YaHei", sans-serif;
        }

        .current-date {
            font-size: 14px;
            color: var(--ks-gray);
            font-weight: 400;
        }

        .todo-status {
            font-size: 11px;
            color: var(--ks-red);
            font-weight: 500;
        }

        .quick-access-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* User Module Container */
        .user-module-container {
            position: relative;
        }

        /* External Toggle Tabs (connected to module) */
        .module-toggle-tabs {
            position: absolute;
            top: -16px;
            right: 0;
            display: flex;
            z-index: 10;
        }

        .toggle-tab {
            width: 32px;
            height: 32px;
            border: none;
            background: white;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.1);
            margin-left: 2px;
            border-bottom: 2px solid #f0f0f0;
        }

        .toggle-tab:hover {
            background: #f8f8f8;
            transform: translateY(-2px);
            box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.15);
        }

        .toggle-tab.active {
            background: white;
            border-bottom: 2px solid white;
            box-shadow: 0 -4px 12px rgba(230, 0, 18, 0.2);
        }

        .toggle-tab img {
            width: 16px;
            height: 16px;
            opacity: 0.7;
            transition: opacity 0.3s;
        }

        .toggle-tab.active img {
            opacity: 1;
            filter: hue-rotate(350deg) saturate(1.5);
        }

        .toggle-tab:hover img {
            opacity: 1;
        }

        .quick-access-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 4px;
            flex: 1;
            margin-bottom: 4px;
        }

        .quick-access-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 6px 4px 8px 4px;
            background: #f8f8f8;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            height: 60px;
            position: relative;
            justify-content: flex-start;
            overflow: hidden;
        }

        .quick-access-item:hover {
            background: linear-gradient(135deg, rgba(230, 0, 18, 0.05), rgba(255, 107, 107, 0.05));
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .quick-access-icon {
            width: 24px;
            height: 24px;
            border-radius: 6px;
            overflow: hidden;
            flex-shrink: 0;
            margin-top: 4px;
            margin-bottom: 2px;
        }

        .quick-access-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .quick-access-name {
            font-size: 11px;
            font-weight: 600;
            line-height: 1.2;
            color: var(--ks-dark);
            transition: opacity 0.3s;
        }

        .quick-access-desc {
            font-size: 9px;
            color: var(--ks-gray);
            line-height: 1.2;
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s;
            position: absolute;
            bottom: 6px;
            left: 2px;
            right: 2px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .quick-access-item:hover .quick-access-name {
            opacity: 0;
        }

        .quick-access-item:hover .quick-access-desc {
            opacity: 1;
        }

        .add-quick-access {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px 4px;
            background: var(--ks-light-gray);
            border: 1px dashed #DDD;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--ks-gray);
            font-size: 16px;
            min-height: 60px;
        }

        .add-quick-access:hover {
            border-color: var(--ks-red);
            background: rgba(230, 0, 18, 0.05);
            color: var(--ks-red);
        }

        /* Todo Module Styles */
        .todo-title-section {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .todo-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--ks-dark);
        }

        .todo-filters {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
        }

        .todo-filter {
            padding: 4px 8px;
            border: 1px solid #E0E0E0;
            border-radius: 6px;
            font-size: 11px;
            background: white;
            color: var(--ks-gray);
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
        }

        .todo-filter:focus {
            outline: none;
            border-color: var(--ks-red);
        }

        .add-todo-btn {
            width: 24px;
            height: 24px;
            border: none;
            background: var(--ks-red);
            color: white;
            border-radius: 50%;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .add-todo-btn:hover {
            background: #CC0010;
            transform: scale(1.1);
        }

        .todo-list {
            flex: 1;
            overflow-y: auto;
            max-height: 220px;
        }

        .todo-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            border-radius: 6px;
            margin-bottom: 6px;
            background: #f8f8f8;
            transition: all 0.3s;
        }

        .todo-item:hover {
            background: rgba(230, 0, 18, 0.05);
        }

        .todo-item.completed {
            opacity: 0.6;
        }

        .todo-item.completed .todo-text {
            text-decoration: line-through;
        }

        .todo-checkbox {
            width: 16px;
            height: 16px;
            border: 2px solid #E0E0E0;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
            position: relative;
            flex-shrink: 0;
        }

        .todo-checkbox.checked {
            background: var(--ks-red);
            border-color: var(--ks-red);
        }

        .todo-checkbox.checked::after {
            content: '✓';
            position: absolute;
            top: -2px;
            left: 2px;
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .todo-text {
            flex: 1;
            font-size: 12px;
            line-height: 1.3;
            color: var(--ks-dark);
        }

        .todo-tags {
            display: flex;
            gap: 4px;
        }

        .todo-tag {
            padding: 2px 6px;
            font-size: 9px;
            border-radius: 4px;
            font-weight: 500;
            opacity: 0.8;
        }

        .todo-tag.work { background: #E3F2FD; color: #1976D2; }
        .todo-tag.personal { background: #F3E5F5; color: #7B1FA2; }
        .todo-tag.meeting { background: #E8F5E8; color: #388E3C; }
        .todo-tag.learning { background: #FFF3E0; color: #F57C00; }

        .todo-priority {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .todo-priority.high { background: #F44336; }
        .todo-priority.medium { background: #FF9800; }
        .todo-priority.low { background: #4CAF50; }

        /* Add Todo Form */
        .add-todo-form {
            background: white;
            border: 1px solid #E0E0E0;
            border-radius: 8px;
            padding: 12px;
            margin-top: 8px;
        }

        .add-todo-form input {
            width: 100%;
            padding: 8px;
            border: 1px solid #E0E0E0;
            border-radius: 6px;
            font-size: 12px;
            margin-bottom: 8px;
        }

        .add-todo-form input:focus {
            outline: none;
            border-color: var(--ks-red);
        }

        .todo-form-controls {
            display: flex;
            gap: 6px;
            align-items: center;
        }

        .todo-form-controls select {
            padding: 4px 6px;
            border: 1px solid #E0E0E0;
            border-radius: 4px;
            font-size: 10px;
            background: white;
            flex: 1;
        }

        .todo-form-controls button {
            padding: 4px 8px;
            border: none;
            border-radius: 4px;
            font-size: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .todo-form-controls button:first-of-type {
            background: var(--ks-red);
            color: white;
        }

        .todo-form-controls button:first-of-type:hover {
            background: #CC0010;
        }

        .todo-form-controls button:last-of-type {
            background: #f8f8f8;
            color: var(--ks-gray);
        }

        .todo-form-controls button:last-of-type:hover {
            background: #E0E0E0;
        }

        /* Main Content Layout */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 24px;
        }

        .left-column {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .right-column {
            display: flex;
            flex-direction: column;
            gap: 0px;
        }

        /* AI Tools TouchBar - MacBook Style */
        .ai-touchbar {
            background: linear-gradient(135deg, #2c2c2c, #1c1c1c);
            border-radius: 18px;
            margin-bottom: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3), inset 0 1px 2px rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .ai-touchbar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
        }
        
        .touchbar-row-1 {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 16px 4px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .touchbar-left {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .touchbar-icon {
            width: 16px;
            height: 16px;
            filter: brightness(0) invert(1);
        }
        
        .touchbar-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .touchbar-title {
            color: white;
            font-size: 12px;
            font-weight: 500;
            letter-spacing: 0.5px;
        }
        
        .touchbar-right {
            display: flex;
            align-items: center;
        }
        
        .touchbar-tabs {
            display: flex;
            gap: 1px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 2px;
        }
        
        .touchbar-tab {
            padding: 4px 8px;
            border-radius: 10px;
            font-size: 10px;
            cursor: pointer;
            transition: all 0.3s;
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            white-space: nowrap;
            font-weight: 400;
        }
        
        .touchbar-tab:hover {
            color: white;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .touchbar-tab.active {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-weight: 500;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }
        
        .touchbar-row-2 {
            display: flex;
            align-items: center;
            padding: 8px 16px 10px;
            gap: 8px;
        }
        
        .touchbar-tools {
            display: flex;
            gap: 10px;
            flex: 1;
            overflow-x: auto;
            scrollbar-width: none;
            padding: 2px 0;
        }
        
        .touchbar-tools::-webkit-scrollbar {
            display: none;
        }
        
        .touchbar-tool {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 6px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            flex-shrink: 0;
            min-width: 50px;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .touchbar-tool:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        
        .touchbar-tool-logo {
            width: 28px;
            height: 28px;
            border-radius: 6px;
            overflow: hidden;
            flex-shrink: 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .touchbar-tool-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .touchbar-tool-name {
            font-size: 9px;
            font-weight: 500;
            color: white;
            text-align: center;
            line-height: 1.2;
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .touchbar-tool-tag {
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 7px;
            padding: 1px 4px;
            border-radius: 6px;
            font-weight: 500;
            line-height: 1;
        }
        
        .touchbar-tool-tag.recent {
            background: rgba(108, 117, 125, 0.9);
            color: white;
        }
        
        .touchbar-tool-tag.hot {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
        }
        
        .touchbar-more {
            display: flex;
            align-items: center;
        }
        
        .touchbar-more-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .touchbar-more-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        
        /* Main Modules */
        .modules-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 24px;
        }

        .module-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            height: 280px;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* Always visible red line */
        .module-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--ks-red), #FF6B6B);
            transform: scaleX(1);
        }

        .module-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        /* Different animations for each module */
        .module-card:nth-child(2)::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--ks-red), transparent);
            animation: wave-effect 3s infinite;
        }

        @keyframes wave-effect {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .module-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .module-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .module-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .module-text {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .module-text-info {
            flex: 1;
        }

        .module-notification {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 11px;
            color: var(--ks-red);
            background: rgba(230, 0, 18, 0.1);
            padding: 2px 8px;
            border-radius: 10px;
            white-space: nowrap;
        }

        .notification-dot {
            width: 6px;
            height: 6px;
            background: var(--ks-red);
            border-radius: 50%;
            animation: pulse-dot 2s infinite;
        }

        @keyframes pulse-dot {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.2); }
        }

        .module-notification.hidden {
            display: none;
        }

        .module-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .module-subtitle {
            font-size: 10px;
            color: var(--ks-gray);
            font-style: italic;
        }

        .module-content {
            flex: 1;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* Module Tabs */
        .module-tabs {
            display: flex;
            gap: 4px;
            background: var(--ks-light-gray);
            border-radius: 20px;
            padding: 2px;
            margin-bottom: 12px;
        }

        .module-tab {
            flex: 1;
            padding: 5px 10px;
            border-radius: 18px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            background: transparent;
            border: none;
            text-align: center;
        }

        .module-tab.active {
            background: white;
            box-shadow: var(--shadow-sm);
            color: var(--ks-red);
        }

        /* AI Tools Module */
        .ai-tools-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            flex: 1;
            overflow-y: auto;
        }

        .ai-tool-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            padding: 8px;
            background: #f8f8f8;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            text-align: center;
        }

        .ai-tool-card:hover {
            background: linear-gradient(135deg, rgba(230, 0, 18, 0.05), rgba(255, 107, 107, 0.05));
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .ai-tool-logo {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .ai-tool-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .ai-tool-info {
            flex: 1;
            width: 100%;
        }

        .ai-tool-name {
            font-size: 11px;
            font-weight: 600;
            margin-bottom: 2px;
            line-height: 1.2;
        }

        .ai-tool-desc {
            font-size: 9px;
            color: var(--ks-gray);
            opacity: 0;
            transition: opacity 0.3s;
            line-height: 1.2;
        }

        .ai-tool-card:hover .ai-tool-desc {
            opacity: 1;
        }

        .view-more-btn {
            padding: 6px 16px;
            margin-top: 8px;
            background: var(--ks-red);
            color: white;
            border: none;
            border-radius: 16px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            align-self: center;
        }

        .view-more-btn:hover {
            background: #CC0010;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(230, 0, 18, 0.3);
        }

        /* Forum Module - Full Width */
        .forum-module-full {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 16px;
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: visible; /* 允许内容溢出到模块外 */
            z-index: 5; /* 设置论坛模块层级，高于小kk(3) */
        }
        
        /* Forum Mascot */
        .forum-mascot {
            position: absolute;
            top: 270px; /* 调整到同事论坛模块上方位置 */
            left: calc(100% - 520px); /* 从左侧定位，确保在同事论坛模块区域 */
            width: 80px;
            height: auto;
            z-index: 3; /* 设置小kk层级：高于banner(1)，低于论坛模块(5) */
            cursor: pointer;
            transition: all 0.4s ease;
            /* 移除默认动画 */
        }
        
        .forum-mascot:hover {
            top: 265px; /* 悬停时向上探出更多 */
            /* 移除摇摆动画 */
        }
        
        /* 移除不需要的动画关键帧 */
        
        .forum-module-full::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--ks-red), #FF6B6B);
        }
        
        .forum-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 16px;
        }
        
        .forum-title-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .forum-icon {
            width: 24px;
            height: 24px;
        }
        
        .forum-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .forum-title h3 {
            font-size: 18px;
            font-weight: 600;
            margin: 0;
            color: var(--ks-dark);
        }
        
        .forum-subtitle {
            font-size: 12px;
            color: var(--ks-gray);
            margin: 2px 0 0 0;
        }
        
        .forum-controls {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .forum-tabs {
            display: flex;
            gap: 4px;
            background: var(--ks-light-gray);
            border-radius: 20px;
            padding: 2px;
        }
        
        .forum-tab {
            padding: 6px 12px;
            border-radius: 18px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            background: transparent;
            border: none;
            white-space: nowrap;
        }
        
        .forum-tab.active {
            background: white;
            box-shadow: var(--shadow-sm);
            color: var(--ks-red);
            font-weight: 500;
        }
        
        .forum-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .forum-content {
            margin-top: 16px;
        }
        
        .forum-cards-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }
        
        .forum-card {
            background: #f8f8f8;
            border-radius: 12px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            min-height: 100px;
            display: flex;
            flex-direction: column;
        }
        
        .forum-card:hover {
            background: linear-gradient(135deg, rgba(230, 0, 18, 0.05), rgba(255, 107, 107, 0.05));
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .forum-card-title {
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 6px;
            line-height: 1.4;
            color: var(--ks-dark);
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }
        
        .forum-card-content {
            font-size: 11px;
            color: var(--ks-gray);
            line-height: 1.5;
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            margin-bottom: 8px;
        }

        .forum-card-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: 6px;
        }

        .forum-card-tag {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: 500;
            color: white;
            flex-shrink: 0;
            margin-left: 8px;
            opacity: 0.5;
        }
        
        .forum-card-meta {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 11px;
            color: var(--ks-gray);
            margin-top: auto;
        }
        
        .forum-card-meta-left {
            display: flex;
            gap: 12px;
        }
        
        .forum-card-meta-right {
            display: flex;
            gap: 8px;
        }
        
        .forum-meta-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .forum-meta-item img {
            width: 12px;
            height: 12px;
        }

        .forum-more {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            margin-top: 16px;
            padding: 6px;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 6px;
        }

        .forum-more:hover {
            background: rgba(230, 0, 18, 0.05);
        }

        .forum-more-link {
            font-size: 12px;
            color: var(--ks-gray);
            font-weight: 500;
        }

        .forum-more svg {
            color: var(--ks-gray);
            transition: all 0.3s;
        }

        .forum-more:hover .forum-more-link,
        .forum-more:hover svg {
            color: var(--ks-red);
        }
        
        /* Forum Module - Legacy */
        .forum-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            flex: 1;
            overflow-y: auto;
        }

        .forum-item {
            padding: 8px;
            background: #f8f8f8;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .forum-item:hover {
            background: linear-gradient(135deg, rgba(230, 0, 18, 0.05), rgba(255, 107, 107, 0.05));
            transform: translateX(4px);
        }

        .forum-title {
            font-size: 12px;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .forum-meta {
            display: flex;
            gap: 12px;
            font-size: 10px;
            color: var(--ks-gray);
        }

        .forum-meta span {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .post-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            padding: 6px 16px;
            margin-top: 8px;
            background: linear-gradient(135deg, var(--ks-red), #FF6B6B);
            color: white;
            border: none;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            align-self: center;
        }

        .post-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(230, 0, 18, 0.3);
        }

        /* Courses Module */
        .course-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            flex: 1;
            overflow-y: auto;
        }

        .course-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            border-radius: 8px;
            background: #f8f8f8;
            transition: all 0.3s;
            cursor: pointer;
        }

        .course-item:hover {
            background: linear-gradient(135deg, rgba(230, 0, 18, 0.05), rgba(255, 107, 107, 0.05));
            transform: translateX(4px);
        }

        .course-img {
            width: 36px;
            height: 36px;
            border-radius: 6px;
            overflow: hidden;
            flex-shrink: 0;
        }

        .course-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .course-info {
            flex: 1;
        }

        .course-name {
            font-size: 12px;
            font-weight: 500;
            margin-bottom: 2px;
        }

        .course-meta {
            font-size: 10px;
            color: var(--ks-gray);
        }

        .course-hot {
            font-size: 10px;
            color: var(--ks-red);
            font-weight: 600;
            padding: 2px 6px;
            background: rgba(230, 0, 18, 0.1);
            border-radius: 8px;
        }

        /* Learning Progress Module */
        .learning-progress-module {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow-sm);
            margin-bottom: 24px;
            position: relative;
            overflow: hidden;
        }
        
        .learning-progress-module::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--ks-red), #FF6B6B);
        }
        
        .learning-header {
            margin-bottom: 10px;
        }
        
        .learning-title-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .learning-icon {
            width: 24px;
            height: 24px;
        }
        
        .learning-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .learning-title h3 {
            font-size: 18px;
            font-weight: 600;
            margin: 0;
            color: var(--ks-dark);
        }
        
        .learning-subtitle {
            font-size: 12px;
            color: var(--ks-gray);
            margin: 2px 0 0 0;
        }
        
        .learning-stats {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
            padding: 14px;
            background: rgba(230, 0, 18, 0.05);
            border-radius: 12px;
            border-left: 3px solid var(--ks-red);
        }
        
        .learning-stat-item {
            text-align: center;
            flex: 1;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: 700;
            color: var(--ks-red);
            margin-bottom: 4px;
            line-height: 1;
        }
        
        .stat-label {
            font-size: 11px;
            color: var(--ks-gray);
            font-weight: 500;
        }
        
        .learning-progress-items {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 16px;
        }
        
        .progress-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 8px;
        }
        
        .progress-course-img {
            width: 36px;
            height: 36px;
            border-radius: 6px;
            overflow: hidden;
            flex-shrink: 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .progress-course-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .progress-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .progress-title {
            font-size: 13px;
            font-weight: 500;
            color: var(--ks-dark);
        }
        
        .progress-meta {
            font-size: 11px;
            color: var(--ks-gray);
        }
        
        .progress-bar {
            height: 6px;
            background: #E0E0E0;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--ks-red), #FF6B6B);
            border-radius: 3px;
            transition: width 0.3s ease;
        }
        
        .learning-actions {
            display: flex;
            justify-content: center;
        }
        
        .more-courses-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 10px 20px;
            background: var(--ks-red);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            justify-content: center;
        }
        
        .more-courses-btn:hover {
            background: #CC0010;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(230, 0, 18, 0.3);
        }
        
        /* Right Column Modules */
        .news-section {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: var(--shadow-sm);
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 20px;
            background: var(--ks-red);
            border-radius: 2px;
        }

        .news-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .news-item {
            padding: 12px;
            background: #f8f8f8;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .news-item:hover {
            background: linear-gradient(135deg, rgba(230, 0, 18, 0.05), rgba(255, 107, 107, 0.05));
            transform: translateX(4px);
        }

        .news-title {
            font-size: 13px;
            color: var(--ks-dark);
            margin-bottom: 4px;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .news-meta {
            font-size: 11px;
            color: var(--ks-gray);
        }

        /* Quotes Module with Dynamic Carousel - Original */
        .quotes-module {
            background: linear-gradient(135deg, white, #FFF8F8);
            border-radius: 16px;
            padding: 24px;
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
            height: 340px;
        }
        
        /* Quotes Module - Bottom Section */
        .quotes-bottom-section {
            margin-top: 60px;
            padding: 40px 0;
            background: #FAFAFA;
            position: relative;
        }

        .quotes-bottom-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--ks-red), transparent);
        }
        
        .quotes-module-bottom {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
            position: relative;
            overflow: hidden;
            min-height: 240px;
            border: 1px solid rgba(0, 0, 0, 0.06);
        }
        
        .quotes-module-bottom::before {
            content: '\201C';
            position: absolute;
            top: -10px;
            left: 20px;
            font-size: 80px;
            color: rgba(230, 0, 18, 0.06);
            font-family: Georgia, serif;
            z-index: 0;
        }

        .quotes-module-bottom::after {
            content: '\201D';
            position: absolute;
            bottom: -20px;
            right: 20px;
            font-size: 80px;
            color: rgba(230, 0, 18, 0.06);
            font-family: Georgia, serif;
            z-index: 0;
        }

        .quotes-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 32px;
            position: relative;
            z-index: 1;
        }

        .quotes-icon {
            width: 24px;
            height: 24px;
            background: var(--ks-red);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .quotes-icon img {
            width: 14px;
            height: 14px;
            filter: brightness(0) invert(1);
        }
        
        .quotes-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--ks-dark);
            margin: 0;
            text-align: center;
        }

        .quotes-subtitle {
            font-size: 13px;
            color: var(--ks-gray);
            margin: 4px 0 0 0;
            text-align: center;
            font-style: italic;
        }

        .quotes-carousel {
            position: relative;
            min-height: 120px;
            z-index: 1;
        }

        .quotes-slides {
            transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .quote-item {
            padding: 24px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 16px;
            border: 1px solid rgba(230, 0, 18, 0.1);
            position: relative;
            margin: 0 auto;
            max-width: 800px;
            text-align: center;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
            backdrop-filter: blur(5px);
        }

        .quote-text {
            font-size: 18px;
            line-height: 1.6;
            color: var(--ks-dark);
            font-style: italic;
            margin-bottom: 16px;
            font-weight: 400;
        }

        .quote-highlight {
            background: linear-gradient(135deg, rgba(230, 0, 18, 0.15), rgba(255, 107, 107, 0.15));
            padding: 3px 8px;
            border-radius: 6px;
            font-weight: 600;
            font-style: normal;
            color: var(--ks-red);
        }

        .quote-author {
            font-size: 14px;
            color: var(--ks-gray);
            font-weight: 500;
        }

        .quotes-navigation {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-top: 24px;
            position: relative;
            z-index: 1;
        }

        .quotes-prev,
        .quotes-next {
            width: 40px;
            height: 40px;
            border: 1px solid #E0E0E0;
            background: white;
            color: var(--ks-red);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .quotes-prev:hover,
        .quotes-next:hover {
            background: var(--ks-red);
            color: white;
            border-color: var(--ks-red);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(230, 0, 18, 0.3);
        }

        .quotes-indicators {
            display: flex;
            gap: 8px;
        }

        .quotes-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(230, 0, 18, 0.3);
            cursor: pointer;
            transition: all 0.3s;
        }

        .quotes-indicator.active {
            background: var(--ks-red);
            transform: scale(1.2);
        }

        .quotes-slides {
            height: 100%;
            transition: transform 0.8s ease-in-out;
        }

        .quotes-slide-pair {
            height: 100%;
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 4px 0;
        }

        .quote-item {
            flex: 1;
            padding: 14px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            border-left: 3px solid var(--ks-red);
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            animation: fadeInUp 0.8s ease-out;
            min-height: 0;
            overflow: auto;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .quote-text {
            font-size: 14px;
            line-height: 1.6;
            color: var(--ks-dark);
            font-style: italic;
            margin-bottom: 8px;
        }

        .quote-highlight {
            background: linear-gradient(135deg, rgba(230, 0, 18, 0.1), rgba(255, 107, 107, 0.1));
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
            font-style: normal;
        }

        .quote-author {
            text-align: right;
            font-size: 12px;
            color: var(--ks-gray);
            margin-top: auto;
        }

        /* Activities Module */
        .activities-module {
            background: linear-gradient(135deg, #FFFFFF, #FFFBF0);
            border-radius: 16px;
            padding: 24px;
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
        }

        .activities-module::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 200, 0, 0.05) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            100% {
                transform: rotate(360deg);
            }
        }

        .activity-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .activity-title img {
            width: 24px;
            height: 24px;
        }

        .activity-item {
            display: flex;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid #F0F0F0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .activity-item:hover {
            padding-left: 8px;
        }

        .activity-date {
            background: var(--ks-red);
            color: white;
            border-radius: 8px;
            padding: 8px;
            min-width: 48px;
            text-align: center;
        }

        .activity-day {
            font-size: 18px;
            font-weight: bold;
        }

        .activity-month {
            font-size: 10px;
        }

        .activity-info {
            flex: 1;
        }

        .activity-name {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .activity-desc {
            font-size: 12px;
            color: var(--ks-gray);
        }

        /* Ranking Module */
        .ranking-module {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: var(--shadow-sm);
            margin-top: 24px;
            position: relative;
            overflow: hidden;
        }

        .ranking-module::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--ks-red), #FF6B6B);
        }

        .ranking-module::after {
            content: '';
            position: absolute;
            top: 5%;
            right: -15%;
            width: 200px;
            height: 200px;
            background-image: url('icon/点赞.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            opacity: 0.15;
            transform: rotate(20deg);
            z-index: 0;
            transition: all 0.3s ease;
        }
        
        .ranking-module.learning::after {
            background-image: url('icon/学习积分.png');
            opacity: 0.18;
        }

        .ranking-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }

        .ranking-title-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .ranking-icon {
            width: 24px;
            height: 24px;
        }

        .ranking-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .ranking-title h3 {
            font-size: 18px;
            font-weight: 600;
            margin: 0;
            color: var(--ks-dark);
        }

        .ranking-subtitle {
            font-size: 12px;
            color: var(--ks-gray);
            margin: 2px 0 0 0;
        }

        .ranking-tabs {
            display: flex;
            gap: 6px;
        }

        .ranking-tab {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background: #f8f8f8;
            border: 1px solid #E0E0E0;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            padding: 6px;
        }

        .ranking-tab:hover {
            background: rgba(230, 0, 18, 0.05);
            border-color: var(--ks-red);
        }

        .ranking-tab.active {
            background: var(--ks-red);
            border-color: var(--ks-red);
        }

        .ranking-tab img {
            width: 16px;
            height: 16px;
            filter: brightness(0.7);
            transition: filter 0.3s;
        }

        .ranking-tab.active img {
            filter: brightness(0) invert(1);
        }

        .ranking-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .ranking-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: #f8f8f8;
            border-radius: 12px;
            transition: all 0.3s;
            position: relative;
        }

        .ranking-item:hover {
            background: linear-gradient(135deg, rgba(230, 0, 18, 0.05), rgba(255, 107, 107, 0.05));
            transform: translateX(4px);
        }

        .ranking-number {
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, var(--ks-red), #FF6B6B);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
        }

        .ranking-item:first-child .ranking-number {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            box-shadow: 0 2px 8px rgba(255, 215, 0, 0.4);
        }

        .ranking-avatar {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            overflow: visible;
            position: relative;
            flex-shrink: 0;
        }

        .ranking-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .gold-needle-badge {
            position: absolute;
            top: -6px;
            right: -6px;
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            z-index: 1;
        }

        .gold-needle-badge img {
            width: 16px;
            height: 16px;
        }

        .gold-needle-text {
            display: inline-block;
            margin-left: 4px;
            padding: 2px 6px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: white;
            font-size: 10px;
            font-weight: bold;
            border-radius: 10px;
            box-shadow: 0 1px 3px rgba(255, 215, 0, 0.3);
        }

        .ranking-info {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ranking-user-info {
            flex: 1;
        }

        .ranking-name {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .ranking-department {
            font-size: 12px;
            color: var(--ks-gray);
        }

        .ranking-likes {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 14px;
            color: var(--ks-red);
            font-weight: 600;
        }

        .ranking-likes img {
            width: 16px;
            height: 16px;
        }

        .my-ranking-btn {
            margin-top: 16px;
            width: 100%;
            padding: 10px;
            background: var(--ks-light-gray);
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            font-size: 13px;
            color: var(--ks-gray);
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .my-ranking-btn:hover {
            background: white;
            border-color: var(--ks-red);
            color: var(--ks-red);
        }

        /* AI Tools Module - Right Column */
        .ai-tools-module {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: var(--shadow-sm);
            margin-bottom: 24px;
            position: relative;
            overflow: hidden;
        }

        .ai-tools-module::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--ks-red), #FF6B6B);
        }

        .ai-tools-header {
            margin-bottom: 16px;
        }

        .ai-tools-title-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .ai-tools-icon {
            width: 24px;
            height: 24px;
        }

        .ai-tools-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .ai-tools-title h3 {
            font-size: 18px;
            font-weight: 600;
            margin: 0;
            color: var(--ks-dark);
        }

        .ai-tools-subtitle {
            font-size: 12px;
            color: var(--ks-gray);
            margin: 2px 0 0 0;
        }

        .ai-tools-tabs {
            display: flex;
            gap: 4px;
            background: var(--ks-light-gray);
            border-radius: 20px;
            padding: 2px;
            margin-bottom: 16px;
        }

        .ai-tools-tab {
            flex: 1;
            padding: 6px 8px;
            border-radius: 18px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s;
            background: transparent;
            border: none;
            text-align: center;
            white-space: nowrap;
        }

        .ai-tools-tab.active {
            background: white;
            box-shadow: var(--shadow-sm);
            color: var(--ks-red);
            font-weight: 500;
        }

        .ai-tools-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 6px;
            margin-bottom: 12px;
        }

        .ai-tool-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            padding: 8px 4px;
            background: #f8f8f8;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            position: relative;
            min-height: 60px;
            justify-content: center;
        }

        .ai-tool-item:hover {
            background: linear-gradient(135deg, rgba(230, 0, 18, 0.05), rgba(255, 107, 107, 0.05));
            transform: translateY(-1px);
        }

        .ai-tool-logo {
            width: 30px;
            height: 30px;
            border-radius: 6px;
            overflow: hidden;
            flex-shrink: 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
        }

        .ai-tool-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .ai-tool-name {
            font-size: 10px;
            font-weight: 500;
            line-height: 1.2;
            color: var(--ks-dark);
            text-align: center;
        }

        .ai-tool-tag {
            position: absolute;
            top: 4px;
            right: 4px;
            font-size: 9px;
            padding: 3px 6px;
            border-radius: 10px;
            font-weight: 600;
            line-height: 1;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        .ai-tool-tag.recent {
            background: rgba(108, 117, 125, 0.9);
            color: white;
        }

        .ai-tool-tag.hot {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
        }

        .ai-tools-more {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            margin-top: 8px;
            padding: 6px;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 6px;
        }

        .ai-tools-more:hover {
            background: rgba(230, 0, 18, 0.05);
        }

        .more-tools-link {
            font-size: 11px;
            color: var(--ks-gray);
            font-weight: 500;
        }

        .ai-tools-more svg {
            color: var(--ks-gray);
            transition: all 0.3s;
        }

        .ai-tools-more:hover .more-tools-link,
        .ai-tools-more:hover svg {
            color: var(--ks-red);
        }

        /* Knowledge Base Section */
        .knowledge-section {
            background: white;
            border-radius: 16px;
            padding: 28px;
            padding-bottom: 20px;
            box-shadow: var(--shadow-sm);
            min-height: 840px;
            margin-top: -30px;
        }

        /* Knowledge Sharing Center Module */
        .knowledge-center-module {
            background: white;
            border-radius: 16px;
            padding: 20px;
            height: 360px;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            margin-top: 24px;
        }

        .knowledge-center-module::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--ks-red), #FF6B6B);
            transform: scaleX(1);
        }

        .knowledge-center-module:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .center-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .center-title-section {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .center-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .center-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .center-title h3 {
            font-size: 16px;
            font-weight: 600;
            margin: 0;
            margin-bottom: 2px;
        }

        .center-subtitle {
            font-size: 10px;
            color: var(--ks-gray);
            font-style: italic;
            margin: 0;
        }

        .center-controls {
            display: flex;
            align-items: center;
        }

        .center-tabs {
            display: flex;
            gap: 4px;
            background: var(--ks-light-gray);
            border-radius: 20px;
            padding: 2px;
        }

        .center-tab {
            flex: 1;
            padding: 5px 10px;
            border-radius: 18px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            background: transparent;
            border: none;
            text-align: center;
            white-space: nowrap;
        }

        .center-tab.active {
            background: white;
            box-shadow: var(--shadow-sm);
            color: var(--ks-red);
        }

        .center-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 10px;
            overflow-y: auto;
            overflow-x: hidden;
            scrollbar-width: none;
        }

        .center-content::-webkit-scrollbar {
            display: none;
        }

        .knowledge-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: #f8f8f8;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .knowledge-item:hover {
            background: linear-gradient(135deg, rgba(230, 0, 18, 0.05), rgba(255, 107, 107, 0.05));
            transform: translateX(4px);
        }

        .knowledge-item-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            background: linear-gradient(135deg, var(--ks-red), #FF6B6B);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .knowledge-item-icon img {
            width: 18px;
            height: 18px;
            filter: brightness(0) invert(1);
        }

        .knowledge-item-content {
            flex: 1;
            min-width: 0;
        }

        .knowledge-item-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--ks-dark);
            margin-bottom: 2px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .knowledge-item-desc {
            font-size: 11px;
            color: var(--ks-gray);
            line-height: 1.3;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .knowledge-item-meta {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 2px;
        }

        .knowledge-item-type {
            font-size: 9px;
            padding: 2px 6px;
            border-radius: 8px;
            font-weight: 500;
            background: rgba(230, 0, 18, 0.1);
            color: var(--ks-red);
        }

        .knowledge-item-views {
            font-size: 9px;
            color: var(--ks-gray);
        }

        .center-more {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            padding: 8px;
            color: var(--ks-gray);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            border-top: 1px solid #F0F0F0;
            margin-top: 8px;
        }

        .center-more:hover {
            color: var(--ks-red);
        }

        .center-more-link {
            font-weight: 500;
        }

        .center-more svg {
            transition: all 0.3s;
        }

        .center-more:hover svg {
            transform: translateX(2px);
        }

        .knowledge-header {
            margin-bottom: 24px;
        }

        .knowledge-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .knowledge-tabs {
            display: flex;
            gap: 8px;
            background: var(--ks-light-gray);
            border-radius: 24px;
            padding: 4px;
        }

        .knowledge-tab {
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            background: transparent;
            border: none;
            font-weight: 500;
        }

        .knowledge-tab.active {
            background: white;
            box-shadow: var(--shadow-sm);
            color: var(--ks-red);
        }

        .knowledge-list {
            display: grid;
            gap: 20px;
        }

        .knowledge-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px;
            background: #f8f8f8;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .knowledge-item:hover {
            background: linear-gradient(135deg, rgba(230, 0, 18, 0.05), rgba(255, 107, 107, 0.05));
            transform: translateX(4px);
        }

        .knowledge-info {
            flex: 1;
        }

        .knowledge-name {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .knowledge-meta {
            display: flex;
            gap: 16px;
            font-size: 12px;
            color: var(--ks-gray);
        }

        .knowledge-meta span {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .knowledge-arrow {
            color: var(--ks-red);
            font-size: 20px;
        }

        .more-link {
            display: inline-block;
            margin-top: 16px;
            padding: 10px 24px;
            background: var(--ks-red);
            color: white;
            text-decoration: none;
            border-radius: 20px;
            font-size: 14px;
            transition: all 0.3s;
            text-align: center;
        }

        .more-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(230, 0, 18, 0.3);
        }

        /* Dynamic Cards styles removed */

        /* Footer */
        .footer {
            background: var(--ks-dark);
            color: white;
            padding: 48px 0 24px;
            margin-top: 80px;
        }

        .footer-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 24px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 48px;
            margin-bottom: 32px;
        }

        .footer-about h3 {
            font-size: 20px;
            margin-bottom: 16px;
        }

        .footer-about p {
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.8;
        }

        .footer-links h4 {
            font-size: 16px;
            margin-bottom: 16px;
        }

        .footer-links ul {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 8px;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-links a:hover {
            color: white;
        }

        .footer-bottom {
            padding-top: 24px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
            font-size: 14px;
        }

        /* Loading Animation */
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }

        .loading {
            animation: pulse 1.5s infinite;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 16px;
            }
            
            .top-section {
                grid-template-columns: 1fr;
                gap: 16px;
            }
            
            .banner-carousel {
                height: 200px;
            }
            
            .user-info-module {
                height: auto;
            }
            
            .quick-access-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .ai-tools-grid {
                grid-template-columns: 1fr;
            }
            
            .forum-cards-grid {
                grid-template-columns: 1fr;
            }
            
            .ranking-list {
                gap: 8px;
            }
        }

        /* Enhanced Animations */
        .module-card {
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        .module-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 12px 28px rgba(0, 0, 0, 0.15);
        }

        .quick-access-item,
        .ai-tool-item,
        .forum-card,
        .ranking-item {
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        /* Loading States */
        .loading-skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Global Search Overlay */
        .search-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 9999;
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }

        .search-overlay.active {
            display: flex;
            align-items: flex-start;
            justify-content: center;
            padding-top: 80px;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .search-modal {
            background: white;
            border-radius: 20px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-30px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .search-modal-header {
            padding: 24px 24px 16px;
            border-bottom: 1px solid #F0F0F0;
        }

        .search-modal-input-wrapper {
            position: relative;
        }

        .search-modal-input {
            width: 100%;
            padding: 14px 50px 14px 20px;
            font-size: 18px;
            border: 2px solid #E0E0E0;
            border-radius: 12px;
            transition: all 0.3s;
        }

        .search-modal-input:focus {
            outline: none;
            border-color: var(--ks-red);
        }

        .search-modal-icon {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            width: 24px;
            height: 24px;
            opacity: 0.5;
        }

        .search-close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 32px;
            height: 32px;
            border: none;
            background: #F5F5F5;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: var(--ks-gray);
            transition: all 0.3s;
        }

        .search-close-btn:hover {
            background: var(--ks-red);
            color: white;
        }

        .search-tabs {
            display: flex;
            gap: 8px;
            padding: 16px 24px;
            border-bottom: 1px solid #F0F0F0;
            overflow-x: auto;
            min-height: 68px;
            align-items: center;
            scrollbar-width: thin;
            scrollbar-color: rgba(0, 0, 0, 0.2) transparent;
        }

        /* 自定义滚动条样式 */
        .search-tabs::-webkit-scrollbar {
            height: 4px;
        }

        .search-tabs::-webkit-scrollbar-track {
            background: transparent;
        }

        .search-tabs::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 2px;
        }

        .search-tabs::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 0, 0, 0.3);
        }

        .search-tab {
            padding: 8px 20px;
            background: transparent;
            border: 1px solid #E0E0E0;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
            position: relative;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            height: 36px;
        }

        .search-tab.active {
            background: var(--ks-red);
            color: white;
            border-color: var(--ks-red);
        }

        .search-tab-count {
            display: inline-block;
            margin-left: 6px;
            padding: 2px 6px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            font-size: 12px;
            min-width: 20px;
            text-align: center;
        }

        .search-tab.active .search-tab-count {
            background: rgba(255, 255, 255, 0.3);
        }

        .search-results {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
        }

        .search-empty {
            text-align: center;
            padding: 60px 20px;
            color: var(--ks-gray);
        }

        .search-empty img {
            width: 80px;
            height: 80px;
            opacity: 0.3;
            margin-bottom: 16px;
        }

        .search-result-item {
            padding: 16px;
            border-radius: 12px;
            background: #F8F8F8;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .search-result-item:hover {
            background: linear-gradient(135deg, rgba(230, 0, 18, 0.05), rgba(255, 107, 107, 0.05));
            transform: translateX(4px);
        }

        .search-result-category {
            display: inline-block;
            padding: 4px 10px;
            background: var(--ks-red);
            color: white;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .search-result-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--ks-dark);
        }

        .search-result-title mark {
            background: rgba(230, 0, 18, 0.2);
            color: var(--ks-red);
            padding: 2px 4px;
            border-radius: 4px;
        }

        .search-result-desc {
            font-size: 14px;
            color: var(--ks-gray);
            line-height: 1.6;
            margin-bottom: 8px;
        }

        .search-result-meta {
            display: flex;
            gap: 16px;
            font-size: 12px;
            color: var(--ks-gray);
        }

        .search-result-meta span {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* Tool Card Style */
        .search-tool-card {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px;
            background: white;
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .search-tool-card:hover {
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
            border-color: var(--ks-red);
        }

        .search-tool-logo {
            width: 48px;
            height: 48px;
            border-radius: 10px;
            overflow: hidden;
            flex-shrink: 0;
        }

        .search-tool-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .search-tool-info {
            flex: 1;
        }

        .search-tool-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .search-tool-desc {
            font-size: 13px;
            color: var(--ks-gray);
        }

        .search-tool-badge {
            padding: 6px 12px;
            background: linear-gradient(135deg, var(--ks-red), #FF6B6B);
            color: white;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <!-- API服务模块 -->
    <script src="js/api.js"></script>
    
    <!-- Header -->
    <header class="header">
        <div class="header-container">
            <div class="logo">
                <img src="01-金山 金山云logo-04.png" alt="金山云">
            </div>
            <nav class="nav-menu">
                <a href="index.html" class="nav-item active">首页</a>
                <div class="nav-dropdown">
                    <div class="nav-dropdown-trigger">
                        <a href="#" class="nav-item">AI工具</a>
                        <img src="icon/下拉箭头.svg" class="dropdown-arrow" alt="下拉">
                    </div>
                    <div class="dropdown-menu">
                        <a href="ai-tools.html" class="dropdown-item">AI工具库</a>
                        <a href="ai-practices.html" class="dropdown-item">AI实战</a>
                        <a href="ai-toolkits.html" class="dropdown-item">专题工具箱</a>
                    </div>
                </div>
                <div class="nav-dropdown forum-dropdown">
                    <div class="nav-dropdown-trigger">
                        <a href="论坛/forum.html" class="nav-item">同事论坛</a>
                        <img src="icon/下拉箭头.svg" class="dropdown-arrow" alt="下拉">
                    </div>
                    <div class="dropdown-menu forum-dropdown-menu">
                        <div class="forum-dropdown-content">
                            <div class="forum-dropdown-section">
                                <h4 class="dropdown-section-title">论坛</h4>
                                <div class="dropdown-items">
                                    <a href="论坛/forum.html?tab=forum&category=qa" class="dropdown-item">问答回响</a>
                                    <a href="论坛/forum.html?tab=forum&category=knowledge" class="dropdown-item">知识分享</a>
                                    <a href="论坛/forum.html?tab=forum&category=life" class="dropdown-item">生活文娱</a>
                                </div>
                            </div>
                            <div class="forum-dropdown-section">
                                <h4 class="dropdown-section-title">资讯</h4>
                                <div class="dropdown-items">
                                    <a href="论坛/forum.html?tab=news&category=company" class="dropdown-item">公司动态</a>
                                    <a href="论坛/forum.html?tab=news&category=industry" class="dropdown-item">行业资讯</a>
                                    <a href="论坛/forum.html?tab=news&category=tech" class="dropdown-item">技术前沿</a>
                                    <a href="论坛/forum.html?tab=news&category=culture" class="dropdown-item">文化长廊</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <a href="#" class="nav-item">学习平台</a>
                <a href="#" class="nav-item">企业活动</a>
            </nav>
            <div class="header-right">
                <div class="search-box">
                    <input type="text" class="search-input" placeholder="搜索...">
                    <button class="search-btn">
                        <img src="icon/搜索.png" alt="搜索" style="width: 16px; height: 16px;">
                    </button>
                </div>
                <button class="notification-btn" onclick="window.location.href='profile.html#notifications'">
                    <img src="icon/通知.png" alt="通知">
                    <div class="notification-badge"></div>
                </button>
                <div class="user-avatar">
                    <div class="avatar-img" style="background-image: url('cd4bd41dc215915e39fa6964ce208923.jpg'); background-size: cover; background-position: center;"></div>
                    <div class="user-dropdown">
                        <div class="dropdown-item" onclick="window.location.href='profile.html'">
                            <img src="icon/用户.svg" alt="个人中心">
                            <span>个人中心</span>
                        </div>
                        <div class="dropdown-item">
                            <img src="icon/目标.svg" alt="我的成就">
                            <span>我的成就</span>
                        </div>
                        <div class="dropdown-divider"></div>
                        <div class="dropdown-item" onclick="window.location.href='settings.html'">
                            <img src="icon/设置.png" alt="设置">
                            <span>设置</span>
                        </div>
                        <div class="dropdown-item" onclick="logout()">
                            <img src="icon/时间.svg" alt="退出">
                            <span>退出登录</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Global Search Overlay -->
    <div class="search-overlay" id="searchOverlay">
        <div class="search-modal">
            <button class="search-close-btn" onclick="closeSearch()">×</button>
            <div class="search-modal-header">
                <div class="search-modal-input-wrapper">
                    <input type="text" class="search-modal-input" id="globalSearchInput" placeholder="搜索资讯、论坛、工具、文档..." autofocus>
                    <img src="icon/搜索.png" class="search-modal-icon" alt="搜索">
                </div>
            </div>
            <div class="search-tabs">
                <button class="search-tab active" onclick="switchSearchTab('all')">
                    全部 <span class="search-tab-count" id="count-all">0</span>
                </button>
                <button class="search-tab" onclick="switchSearchTab('news')">
                    资讯 <span class="search-tab-count" id="count-news">0</span>
                </button>
                <button class="search-tab" onclick="switchSearchTab('forum')">
                    论坛 <span class="search-tab-count" id="count-forum">0</span>
                </button>
                <button class="search-tab" onclick="switchSearchTab('tools')">
                    工具库 <span class="search-tab-count" id="count-tools">0</span>
                </button>
                <button class="search-tab" onclick="switchSearchTab('docs')">
                    知识文档 <span class="search-tab-count" id="count-docs">0</span>
                </button>
            </div>
            <div class="search-results" id="searchResults">
                <div class="search-empty">
                    <img src="icon/搜索.png" alt="搜索">
                    <p>输入关键词开始搜索</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Background Pattern -->
    <div class="bg-pattern"></div>
    
    <!-- Main Content -->
    <div class="container">
        <!-- Top Section with Banner and User Info -->
        <div class="top-section">
            <!-- Banner Carousel with Thumbnails -->
            <div class="banner-carousel">
                <div class="banner-main">
                    <div class="banner-slides" id="bannerSlides">
                        <div class="banner-slide">
                            <img src="banner/banner.jpg" alt="Banner 1">
                            <div class="banner-slide-title">如何做好一名好的管理者 ——邹涛</div>
                        </div>
                        <div class="banner-slide">
                            <img src="banner/banner2.jpg" alt="Banner 2">
                            <div class="banner-slide-title">云耀时刻正式开始接受报名</div>
                        </div>
                        <div class="banner-slide">
                            <img src="banner/banner3.png" alt="Banner 3">
                            <div class="banner-slide-title">谈谈到底怎么用好Deepseek</div>
                        </div>
                        <div class="banner-slide">
                            <img src="banner/banner4.png" alt="Banner 4">
                            <div class="banner-slide-title">金山星期二 WPS AI日常办公提效</div>
                        </div>
                    </div>
                </div>
                <div class="banner-thumbnails" id="bannerThumbnails">
                    <div class="thumbnail-item active" data-slide="0">
                        <img src="banner/banner.jpg" alt="缩略图 1">
                        <div class="thumbnail-overlay">企业文化</div>
                    </div>
                    <div class="thumbnail-item" data-slide="1">
                        <img src="banner/banner2.jpg" alt="缩略图 2">
                        <div class="thumbnail-overlay">技术创新</div>
                    </div>
                    <div class="thumbnail-item" data-slide="2">
                        <img src="banner/banner3.png" alt="缩略图 3">
                        <div class="thumbnail-overlay">团队协作</div>
                    </div>
                    <div class="thumbnail-item" data-slide="3">
                        <img src="banner/banner4.png" alt="缩略图 4">
                        <div class="thumbnail-overlay">未来愿景</div>
                    </div>
                </div>
            </div>

            <!-- User Info & Quick Access Module with External Toggle -->
            <div class="user-module-container">
                <!-- User Info Module -->
                <div class="user-info-module">
                    <!-- User Info Header (show in quick mode only) -->
                    <div class="user-info-header" id="userInfoHeader">
                        <div class="user-avatar-large">
                            <span class="user-level-badge">LV6</span>
                        </div>
                        <div class="user-details">
                            <div class="user-name">谢其乐</div>
                            <div class="user-department">技术研发部</div>
                        </div>
                        <div class="date-info">
                            <div class="date-row">
                                <span class="current-weekday" id="currentWeekday">星期三</span>
                                <span class="current-date" id="currentDate">9月10号</span>
                            </div>
                            <div class="todo-status" id="todoStatus">您有3件待办未处理</div>
                        </div>
                    </div>

                    <!-- Quick Access Content (Default) -->
                    <div class="module-content" id="quickAccessContent">
                        <div class="quick-access-title">快捷入口</div>
                        <div class="quick-access-grid">
                            <div class="quick-access-item">
                                <div class="quick-access-icon">
                                    <img src="快捷入口/isee.png" alt="isee">
                                </div>
                                <div class="quick-access-name">isee</div>
                                <div class="quick-access-desc">BI数据洞察平台</div>
                            </div>
                            <div class="quick-access-item">
                                <div class="quick-access-icon">
                                    <img src="快捷入口/HCM.png" alt="HCM">
                                </div>
                                <div class="quick-access-name">HCM</div>
                                <div class="quick-access-desc">人力资源系统</div>
                            </div>
                            <div class="quick-access-item">
                                <div class="quick-access-icon">
                                    <img src="快捷入口/KOA.png" alt="KOA">
                                </div>
                                <div class="quick-access-name">KOA</div>
                                <div class="quick-access-desc">内网门户系统</div>
                            </div>
                            <div class="quick-access-item">
                                <div class="quick-access-icon">
                                    <img src="快捷入口/USS.png" alt="USS">
                                </div>
                                <div class="quick-access-name">USS</div>
                                <div class="quick-access-desc">运营管理平台</div>
                            </div>
                            <div class="quick-access-item">
                                <div class="quick-access-icon">
                                    <img src="快捷入口/ezOne.png" alt="ezOne">
                                </div>
                                <div class="quick-access-name">ezOne</div>
                                <div class="quick-access-desc">DevOps开发平台</div>
                            </div>
                            <div class="add-quick-access">
                                +
                            </div>
                        </div>
                    </div>

                    <!-- Todo Content (Hidden by Default) -->
                    <div class="module-content" id="todoContent" style="display: none;">
                        <div class="todo-title-section">
                            <div class="todo-title">待办事项</div>
                            <button class="add-todo-btn" onclick="showAddTodoForm()">
                                <span>+</span>
                            </button>
                        </div>
                        
                        <div class="todo-filters">
                            <select class="todo-filter" id="tagFilter">
                                <option value="all">所有标签</option>
                                <option value="work">工作</option>
                                <option value="personal">个人</option>
                                <option value="meeting">会议</option>
                                <option value="learning">学习</option>
                            </select>
                            <select class="todo-filter" id="priorityFilter">
                                <option value="all">所有优先级</option>
                                <option value="high">高优先级</option>
                                <option value="medium">中优先级</option>
                                <option value="low">低优先级</option>
                            </select>
                        </div>
                        
                        <div class="todo-list" id="todoList">
                            <!-- Todo items will be loaded dynamically -->
                        </div>
                        
                        <!-- Add Todo Form -->
                        <div class="add-todo-form" id="addTodoForm" style="display: none;">
                            <input type="text" id="todoTitle" placeholder="输入待办事项..." maxlength="50">
                            <div class="todo-form-controls">
                                <select id="todoTag">
                                    <option value="work">工作</option>
                                    <option value="personal">个人</option>
                                    <option value="meeting">会议</option>
                                    <option value="learning">学习</option>
                                </select>
                                <select id="todoPriority">
                                    <option value="medium">中优先级</option>
                                    <option value="high">高优先级</option>
                                    <option value="low">低优先级</option>
                                </select>
                                <button type="button" onclick="addTodo()">添加</button>
                                <button type="button" onclick="hideAddTodoForm()">取消</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- External Toggle Tabs (connected to module) -->
                <div class="module-toggle-tabs">
                    <button class="toggle-tab active" onclick="switchUserModule('quick')" title="快捷入口">
                        <img src="icon/搜索.png" alt="快捷入口">
                    </button>
                    <button class="toggle-tab" onclick="switchUserModule('todo')" title="待办事项">
                        <img src="icon/待办事项.png" alt="待办事项">
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Content Layout -->
        <div class="main-content">
            <div class="left-column">

                <!-- Forum Mascot - 放在论坛模块外面作为独立元素 -->
                <img src="小kk.gif" alt="公司吉祥物小kk" class="forum-mascot" title="大家好！我是小kk，欢迎来到同事论坛！">
                
                <!-- Forum Module - Full Width -->
                <div class="forum-module-full">
                    <div class="forum-header">
                        <div class="forum-title-section">
                            <div class="forum-icon">
                                <img src="icon/论坛.png" alt="同事论坛">
                            </div>
                            <div class="forum-title">
                                <h3>同事论坛</h3>
                                <p class="forum-subtitle">同事们在这里交流分享</p>
                            </div>
                        </div>
                        <div class="forum-controls">
                            <div class="forum-tabs">
                                <button class="forum-tab active" onmouseover="switchForumTabFull(event, 'hot')">热门</button>
                                <button class="forum-tab" onmouseover="switchForumTabFull(event, 'latest')">最新</button>
                                <button class="forum-tab" onmouseover="switchForumTabFull(event, 'knowledge')">知识</button>
                                <button class="forum-tab" onmouseover="switchForumTabFull(event, 'life')">生活</button>
                            </div>
                            <div class="forum-actions">
                                <button class="post-btn" onclick="window.location.href='论坛/create-post.html'">
                                    <span>+</span>
                                    <span>发帖</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="forum-content">
                        <div class="forum-cards-grid" id="forumCardsGrid">
                            <!-- Forum cards will be loaded dynamically in 2x2 layout -->
                        </div>
                        <div class="forum-more">
                            <span class="forum-more-link" onclick="window.location.href='论坛/forum.html'">查看更多</span>
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
                                <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </div>
                    </div>
                </div>

                <!-- Main Modules -->
                <div class="modules-grid">
                    <!-- No modules here now -->
                </div>

                <!-- Enterprise Information Forum Section -->
                <div class="knowledge-section">
                    <div class="knowledge-header">
                        <h2 class="knowledge-title">
                            <span>企业资讯论坛</span>
                        </h2>
                        <div class="knowledge-tabs">
                            <button class="knowledge-tab active" onmouseover="switchKnowledgeTab(event, 'all')">全部</button>
                            <button class="knowledge-tab" onmouseover="switchKnowledgeTab(event, 'tech')">技术洞察</button>
                            <button class="knowledge-tab" onmouseover="switchKnowledgeTab(event, 'culture')">文化长廊</button>
                            <button class="knowledge-tab" onmouseover="switchKnowledgeTab(event, 'company')">公司大事</button>
                        </div>
                    </div>
                    <div class="knowledge-list" id="knowledgeList">
                        <!-- Knowledge items will be loaded dynamically -->
                    </div>
                    <a href="论坛/forum.html?tab=news&category=company" class="more-link">查看更多</a>
                </div>

                <!-- Knowledge Sharing Center Module -->
                <div class="knowledge-center-module">
                    <div class="center-header">
                        <div class="center-title-section">
                            <div class="center-icon">
                                <img src="icon/灯泡.svg" alt="知识分享">
                            </div>
                            <div class="center-title">
                                <h3>知识分享中心</h3>
                                <p class="center-subtitle">技术文档和学习资源集合</p>
                            </div>
                        </div>
                        <div class="center-controls">
                            <div class="center-tabs">
                                <button class="center-tab active" onmouseover="switchCenterTab(event, 'all')">全部</button>
                                <button class="center-tab" onmouseover="switchCenterTab(event, 'docs')">文档</button>
                                <button class="center-tab" onmouseover="switchCenterTab(event, 'tutorials')">教程</button>
                                <button class="center-tab" onmouseover="switchCenterTab(event, 'resources')">资源</button>
                            </div>
                        </div>
                    </div>
                    <div class="center-content" id="centerContent">
                        <!-- Knowledge items will be loaded dynamically -->
                    </div>
                    <div class="center-more">
                        <span class="center-more-link">更多知识内容</span>
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
                            <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="right-column">
                <!-- AI Tools Module -->
                <div class="ai-tools-module">
                    <div class="ai-tools-header">
                        <div class="ai-tools-title-section">
                            <div class="ai-tools-icon">
                                <img src="icon/AI工具箱.png" alt="AI工具箱">
                            </div>
                            <div class="ai-tools-title">
                                <h3>AI工具箱</h3>
                                <p class="ai-tools-subtitle">智能工具集合</p>
                            </div>
                        </div>
                    </div>
                    <div class="ai-tools-tabs">
                        <button class="ai-tools-tab active" onmouseover="switchAITools(event, 'recent')">推荐</button>
                        <button class="ai-tools-tab" onmouseover="switchAITools(event, 'hot')">热门</button>
                        <button class="ai-tools-tab" onmouseover="switchAITools(event, 'office')">办公</button>
                        <button class="ai-tools-tab" onmouseover="switchAITools(event, 'code')">代码</button>
                    </div>
                    <div class="ai-tools-grid" id="aiToolsGrid">
                        <!-- AI tools will be loaded dynamically -->
                    </div>
                    <div class="ai-tools-more" onclick="window.location.href='ai-tools.html'" style="cursor: pointer;">
                        <span class="more-tools-link">更多工具</span>
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
                            <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                </div>

                <!-- Learning Platform Module -->
                <div class="learning-progress-module">
                    <div class="learning-header">
                        <div class="learning-title-section">
                            <div class="learning-icon">
                                <img src="icon/学习平台.png" alt="学习平台">
                            </div>
                            <div class="learning-title">
                                <h3>学习平台</h3>
                                <p class="learning-subtitle">个人学习数据</p>
                            </div>
                        </div>
                    </div>
                    <div class="learning-stats">
                        <div class="learning-stat-item">
                            <div class="stat-number">12</div>
                            <div class="stat-label">已完成课程</div>
                        </div>
                        <div class="learning-stat-item">
                            <div class="stat-number">156</div>
                            <div class="stat-label">学习小时</div>
                        </div>
                        <div class="learning-stat-item">
                            <div class="stat-number">3</div>
                            <div class="stat-label">进行中课程</div>
                        </div>
                    </div>
                    <div class="learning-progress-items">
                        <div class="progress-item">
                            <div class="progress-course-img">
                                <img src="课程图片/2.png" alt="Claude Code 实战">
                            </div>
                            <div class="progress-content">
                                <div class="progress-info">
                                    <div class="progress-title">Claude Code 实战</div>
                                    <div class="progress-meta">75% 完成</div>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 75%"></div>
                                </div>
                            </div>
                        </div>
                        <div class="progress-item">
                            <div class="progress-course-img">
                                <img src="课程图片/1.png" alt="云原生架构">
                            </div>
                            <div class="progress-content">
                                <div class="progress-info">
                                    <div class="progress-title">云原生架构</div>
                                    <div class="progress-meta">45% 完成</div>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 45%"></div>
                                </div>
                            </div>
                        </div>
                        <div class="progress-item">
                            <div class="progress-course-img">
                                <img src="课程图片/3.png" alt="数据分析入门">
                            </div>
                            <div class="progress-content">
                                <div class="progress-info">
                                    <div class="progress-title">数据分析入门</div>
                                    <div class="progress-meta">20% 完成</div>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 20%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="learning-actions">
                        <button class="more-courses-btn">
                            <span>更多课程</span>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Activities Module -->
                <div class="activities-module">
                    <h3 class="activity-title">
                        <img src="icon/活动.png" alt="活动">
                        最新活动
                    </h3>
                    <div class="activity-item">
                        <div class="activity-date">
                            <div class="activity-day">25</div>
                            <div class="activity-month">JAN</div>
                        </div>
                        <div class="activity-info">
                            <div class="activity-name">年度技术分享大会</div>
                            <div class="activity-desc">分享技术心得，共同成长进步</div>
                        </div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-date">
                            <div class="activity-day">28</div>
                            <div class="activity-month">JAN</div>
                        </div>
                        <div class="activity-info">
                            <div class="activity-name">新春团建活动</div>
                            <div class="activity-desc">欢聚一堂，共迎新春佳节</div>
                        </div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-date">
                            <div class="activity-day">02</div>
                            <div class="activity-month">FEB</div>
                        </div>
                        <div class="activity-info">
                            <div class="activity-name">AI创新工作坊</div>
                            <div class="activity-desc">探索AI应用，激发创新思维</div>
                        </div>
                    </div>
                </div>

                <!-- Ranking Module -->
                <div class="ranking-module">
                    <div class="ranking-header">
                        <div class="ranking-title-section">
                            <div class="ranking-icon">
                                <img src="icon/排行榜.png" alt="排行榜" id="rankingIcon">
                            </div>
                            <div class="ranking-title">
                                <h3 id="rankingTitle">排行榜</h3>
                                <p class="ranking-subtitle" id="rankingSubtitle">赞一赞月排名</p>
                            </div>
                        </div>
                        <div class="ranking-tabs">
                            <button class="ranking-tab active" onclick="switchRanking(event, 'likes')">
                                <img src="icon/点赞.png" alt="点赞">
                            </button>
                            <button class="ranking-tab" onclick="switchRanking(event, 'learning')">
                                <img src="icon/学习积分.png" alt="学习积分">
                            </button>
                        </div>
                    </div>
                    <div class="ranking-list">
                        <div class="ranking-item">
                            <div class="ranking-number">1</div>
                            <div class="ranking-avatar">
                                <img src="头像/张秋实-技术委员会.png" alt="张秋实">
                                <div class="gold-needle-badge">
                                    <img src="icon/金指针.png" alt="金指针">
                                </div>
                            </div>
                            <div class="ranking-info">
                                <div class="ranking-user-info">
                                    <div class="ranking-name">
                                        张秋实
                                        <span class="gold-needle-text">金指针</span>
                                    </div>
                                    <div class="ranking-department">技术委员会</div>
                                </div>
                            </div>
                            <div class="ranking-likes">
                                <img src="icon/点赞.png" alt="点赞">
                                <span>1,234</span>
                            </div>
                        </div>
                        <div class="ranking-item">
                            <div class="ranking-number">2</div>
                            <div class="ranking-avatar">
                                <img src="头像/赵小萱-技术委员会.png" alt="赵小萱">
                            </div>
                            <div class="ranking-info">
                                <div class="ranking-user-info">
                                    <div class="ranking-name">赵小萱</div>
                                    <div class="ranking-department">技术委员会</div>
                                </div>
                            </div>
                            <div class="ranking-likes">
                                <img src="icon/点赞.png" alt="点赞">
                                <span>986</span>
                            </div>
                        </div>
                        <div class="ranking-item">
                            <div class="ranking-number">3</div>
                            <div class="ranking-avatar">
                                <img src="头像/高通-组织和人力资源.jpg" alt="高通">
                            </div>
                            <div class="ranking-info">
                                <div class="ranking-user-info">
                                    <div class="ranking-name">高通</div>
                                    <div class="ranking-department">组织和人力资源</div>
                                </div>
                            </div>
                            <div class="ranking-likes">
                                <img src="icon/点赞.png" alt="点赞">
                                <span>856</span>
                            </div>
                        </div>
                    </div>
                    <button class="my-ranking-btn">
                        我的排名
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Quotes Module - Enhanced Design -->
    <div class="quotes-bottom-section">
        <div class="container">
            <div class="quotes-module-bottom">
                <div class="quotes-header">
                    <div class="quotes-icon">
                        <img src="icon/明星.svg" alt="价值语录">
                    </div>
                    <h3 class="quotes-title">价值语录</h3>
                    <p class="quotes-subtitle">启迪智慧，引领未来</p>
                </div>
                <div class="quotes-carousel" id="quotesCarousel">
                    <div class="quotes-slides" id="quotesSlides">
                        <!-- Quotes will be dynamically loaded -->
                    </div>
                    <div class="quotes-navigation">
                        <button class="quotes-prev" onclick="previousQuote()">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                                <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                        <div class="quotes-indicators" id="quotesIndicators">
                            <!-- Indicators will be generated dynamically -->
                        </div>
                        <button class="quotes-next" onclick="nextQuote()">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                                <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-about">
                    <h3>金山云企业文化窗口</h3>
                    <p>致力于打造开放、创新、协作的企业文化平台，让每一位员工都能在这里找到归属感，共同成长，共创辉煌。</p>
                </div>
                <div class="footer-links">
                    <h4>快速链接</h4>
                    <ul>
                        <li><a href="#">关于我们</a></li>
                        <li><a href="#">企业文化</a></li>
                        <li><a href="#">加入我们</a></li>
                        <li><a href="#">联系我们</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h4>资源中心</h4>
                    <ul>
                        <li><a href="#">学习资料</a></li>
                        <li><a href="#">技术文档</a></li>
                        <li><a href="#">视频教程</a></li>
                        <li><a href="#">开发工具</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h4>关注我们</h4>
                    <ul>
                        <li><a href="#">企业微信</a></li>
                        <li><a href="#">内部论坛</a></li>
                        <li><a href="#">技术博客</a></li>
                        <li><a href="#">公众号</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>© 2025 金山云. All Rights Reserved. | 让云计算成为企业发展新动力</p>
            </div>
        </div>
    </footer>

    <!-- 登录/注册模态框 -->
    <div id="authModal" class="auth-modal" style="display: none;">
        <div class="auth-modal-content">
            <div class="auth-modal-header">
                <h3 id="authModalTitle">登录</h3>
                <button class="auth-modal-close" onclick="closeAuthModal()">&times;</button>
            </div>
            <div class="auth-modal-body">
                <!-- 登录表单 -->
                <form id="loginForm" class="auth-form">
                    <div class="form-group">
                        <label>用户名</label>
                        <input type="text" id="loginUsername" required>
                    </div>
                    <div class="form-group">
                        <label>密码</label>
                        <input type="password" id="loginPassword" required>
                    </div>
                    <button type="submit" class="auth-btn">登录</button>
                    <div class="auth-switch">
                        还没有账号？<a href="#" onclick="switchToRegister()">立即注册</a>
                    </div>
                </form>

                <!-- 注册表单 -->
                <form id="registerForm" class="auth-form" style="display: none;">
                    <div class="form-group">
                        <label>用户名</label>
                        <input type="text" id="registerUsername" required>
                    </div>
                    <div class="form-group">
                        <label>邮箱</label>
                        <input type="email" id="registerEmail" required>
                    </div>
                    <div class="form-group">
                        <label>姓名</label>
                        <input type="text" id="registerFullName" required>
                    </div>
                    <div class="form-group">
                        <label>部门</label>
                        <input type="text" id="registerDepartment" required>
                    </div>
                    <div class="form-group">
                        <label>密码</label>
                        <input type="password" id="registerPassword" required>
                    </div>
                    <div class="form-group">
                        <label>确认密码</label>
                        <input type="password" id="registerConfirmPassword" required>
                    </div>
                    <button type="submit" class="auth-btn">注册</button>
                    <div class="auth-switch">
                        已有账号？<a href="#" onclick="switchToLogin()">立即登录</a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <style>
        /* 登录模态框样式 */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .auth-modal-content {
            background: white;
            border-radius: 12px;
            width: 400px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
        }

        .auth-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #E0E0E0;
        }

        .auth-modal-header h3 {
            margin: 0;
            color: var(--ks-red);
        }

        .auth-modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }

        .auth-modal-body {
            padding: 20px;
        }

        .auth-form .form-group {
            margin-bottom: 16px;
        }

        .auth-form label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--ks-dark);
        }

        .auth-form input {
            width: 100%;
            padding: 12px;
            border: 1px solid #E0E0E0;
            border-radius: 6px;
            font-size: 14px;
        }

        .auth-form input:focus {
            outline: none;
            border-color: var(--ks-red);
        }

        .auth-btn {
            width: 100%;
            padding: 12px;
            background: var(--ks-red);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            margin-bottom: 16px;
        }

        .auth-btn:hover {
            background: #CC0010;
        }

        .auth-switch {
            text-align: center;
            font-size: 14px;
            color: var(--ks-gray);
        }

        .auth-switch a {
            color: var(--ks-red);
            text-decoration: none;
        }

        .auth-switch a:hover {
            text-decoration: underline;
        }
    </style>

    <script>
        // ========== API数据加载功能 ==========
        
        // 页面加载时初始化数据
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                // 更新日期显示
                updateDateDisplay();
                
                // 初始化待办事项功能
                initTodoFeatures();
                
                // 并行加载所有API数据
                await Promise.all([
                    loadBanners(),
                    loadQuotes(),
                    loadQuickAccess(),
                    updateUserInfo()
                ]);
            } catch (error) {
                console.error('数据加载失败:', error);
                // 如果API失败，使用默认静态数据
            }
        });

        // 初始化待办事项功能
        function initTodoFeatures() {
            // 初始化待办事项列表
            renderTodoList();
            
            // 添加筛选器事件监听
            const tagFilter = document.getElementById('tagFilter');
            const priorityFilter = document.getElementById('priorityFilter');
            if (tagFilter) tagFilter.addEventListener('change', filterTodos);
            if (priorityFilter) priorityFilter.addEventListener('change', filterTodos);
            
            // 添加回车键支持
            const todoTitleInput = document.getElementById('todoTitle');
            if (todoTitleInput) {
                todoTitleInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        addTodo();
                    }
                });
            }
        }

        // 加载轮播图数据
        async function loadBanners() {
            try {
                const banners = await apiService.getBanners();
                if (banners && banners.results && banners.results.length > 0) {
                    updateBannerDisplay(banners.results);
                }
            } catch (error) {
                console.error('轮播图加载失败:', error);
            }
        }

        // 更新轮播图显示
        function updateBannerDisplay(banners) {
            const slidesContainer = document.getElementById('bannerSlides');
            const thumbnailsContainer = document.getElementById('bannerThumbnails');
            
            // 更新轮播图内容
            slidesContainer.innerHTML = banners.map(banner => `
                <div class="banner-slide">
                    <img src="${banner.image || 'banner/banner.jpg'}" alt="${banner.title}">
                    <div class="banner-slide-title">${banner.title}</div>
                </div>
            `).join('');

            // 更新缩略图
            thumbnailsContainer.innerHTML = banners.map((banner, index) => `
                <div class="thumbnail-item ${index === 0 ? 'active' : ''}" data-slide="${index}">
                    <img src="${banner.image || 'banner/banner.jpg'}" alt="缩略图 ${index + 1}">
                    <div class="thumbnail-overlay">${banner.subtitle || banner.title}</div>
                </div>
            `).join('');

            // 更新总slides数量
            totalSlides = banners.length;
            
            // 重新绑定缩略图事件
            bindThumbnailEvents();
        }

        // 加载每日金句
        async function loadQuotes() {
            try {
                const quotes = await apiService.getQuotes();
                if (quotes && quotes.results) {
                    updateQuotesDisplay(quotes.results);
                }
            } catch (error) {
                console.error('金句加载失败:', error);
            }
        }

        // 更新金句显示
        function updateQuotesDisplay(quotes) {
            // 重新格式化quotes数据结构，因为静态数据是二维数组
            const formattedQuotes = [];
            for (let i = 0; i < quotes.length; i += 2) {
                formattedQuotes.push(quotes.slice(i, i + 2));
            }
            quotesData.length = 0; // 清空原有数据
            quotesData.push(...formattedQuotes.map(group => 
                group.map(quote => ({
                    text: quote.content,
                    author: `—— ${quote.author}`
                }))
            ));
            
            // 重新初始化金句轮播
            if (quotesData.length > 0) {
                initQuotesCarousel();
            }
        }

        // 加载快捷入口
        async function loadQuickAccess() {
            try {
                const quickAccess = await apiService.getQuickAccess();
                if (quickAccess && quickAccess.results) {
                    updateQuickAccessDisplay(quickAccess.results);
                }
            } catch (error) {
                console.error('快捷入口加载失败:', error);
            }
        }

        // 更新快捷入口显示
        function updateQuickAccessDisplay(quickAccess) {
            const container = document.querySelector('.quick-apps-grid');
            if (container && quickAccess.length > 0) {
                container.innerHTML = quickAccess.map(app => `
                    <div class="quick-app-item" onclick="openQuickApp('${app.url}')">
                        <div class="quick-app-icon">
                            <img src="${app.icon || 'icon/学习平台.png'}" alt="${app.name}">
                        </div>
                        <span>${app.name}</span>
                    </div>
                `).join('');
            }
        }

        // 更新用户信息
        async function updateUserInfo() {
            try {
                if (!apiService.isLoggedIn()) return;
                
                const userInfo = await apiService.getUserInfo();
                if (userInfo) {
                    const userNameEl = document.querySelector('.user-name');
                    const userDeptEl = document.querySelector('.user-department');
                    const userLevelEl = document.querySelector('.user-level-badge');
                    
                    if (userNameEl) userNameEl.textContent = userInfo.first_name + userInfo.last_name || userInfo.username;
                    if (userDeptEl) userDeptEl.textContent = userInfo.department || '技术部';
                    if (userLevelEl) userLevelEl.textContent = `LV${userInfo.level || 1}`;
                }
            } catch (error) {
                console.error('用户信息加载失败:', error);
            }
        }

        // 更新日期显示
        function updateDateDisplay() {
            const now = new Date();
            const weekdays = ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六'];
            const months = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];
            
            const weekday = weekdays[now.getDay()];
            const month = months[now.getMonth()];
            const date = now.getDate() + '号';
            
            const weekdayEl = document.getElementById('currentWeekday');
            const dateEl = document.getElementById('currentDate');
            
            if (weekdayEl) weekdayEl.textContent = weekday;
            if (dateEl) dateEl.textContent = month + date;
        }

        // 快捷应用点击处理
        function openQuickApp(url) {
            window.open(url, '_blank');
        }

        // ========== 待办事项功能 ==========
        
        // 用户模块切换功能
        function switchUserModule(module) {
            const toggleTabs = document.querySelectorAll('.toggle-tab');
            const quickAccessContent = document.getElementById('quickAccessContent');
            const todoContent = document.getElementById('todoContent');
            const userInfoHeader = document.getElementById('userInfoHeader');
            
            // 更新切换按钮状态
            toggleTabs.forEach(tab => tab.classList.remove('active'));
            
            if (module === 'quick') {
                document.querySelector('.toggle-tab[onclick*="quick"]').classList.add('active');
                quickAccessContent.style.display = 'block';
                todoContent.style.display = 'none';
                userInfoHeader.style.display = 'flex';
            } else if (module === 'todo') {
                document.querySelector('.toggle-tab[onclick*="todo"]').classList.add('active');
                quickAccessContent.style.display = 'none';
                todoContent.style.display = 'block';
                userInfoHeader.style.display = 'none';
                // 切换到待办模块时初始化待办列表
                if (typeof renderTodoList === 'function') {
                    renderTodoList();
                }
            }
        }
        
        // 模块切换功能（保持兼容性）
        function switchModule(module) {
            switchUserModule(module);
        }
        
        // 待办事项数据
        let todoItems = [
            {
                id: 1,
                text: '完成项目周报',
                tag: 'work',
                priority: 'high',
                completed: false,
                source: '工作系统'
            },
            {
                id: 2,
                text: '团队会议准备',
                tag: 'meeting',
                priority: 'medium',
                completed: false,
                source: '日历系统'
            },
            {
                id: 3,
                text: '学习新技术文档',
                tag: 'learning',
                priority: 'low',
                completed: true,
                source: '学习平台'
            }
        ];
        
        // 渲染待办事项列表
        function renderTodoList() {
            const todoList = document.getElementById('todoList');
            const tagFilter = document.getElementById('tagFilter')?.value || 'all';
            const priorityFilter = document.getElementById('priorityFilter')?.value || 'all';
            
            let filteredItems = todoItems.filter(item => {
                const tagMatch = tagFilter === 'all' || item.tag === tagFilter;
                const priorityMatch = priorityFilter === 'all' || item.priority === priorityFilter;
                return tagMatch && priorityMatch;
            });
            
            // 按完成状态和优先级排序
            filteredItems.sort((a, b) => {
                if (a.completed !== b.completed) {
                    return a.completed ? 1 : -1;
                }
                const priorityOrder = { high: 3, medium: 2, low: 1 };
                return priorityOrder[b.priority] - priorityOrder[a.priority];
            });
            
            if (todoList) {
                todoList.innerHTML = filteredItems.map(item => `
                    <div class="todo-item ${item.completed ? 'completed' : ''}">
                        <div class="todo-checkbox ${item.completed ? 'checked' : ''}" onclick="toggleTodo(${item.id})"></div>
                        <div class="todo-text">${item.text}</div>
                        <div class="todo-tags">
                            <span class="todo-tag ${item.tag}">${getTagName(item.tag)}</span>
                        </div>
                        <div class="todo-priority ${item.priority}"></div>
                    </div>
                `).join('');
            }
            
            // 更新待办数量
            updateTodoCount();
        }
        
        // 获取标签显示名称
        function getTagName(tag) {
            const tagNames = {
                work: '工作',
                personal: '个人',
                meeting: '会议',
                learning: '学习'
            };
            return tagNames[tag] || tag;
        }
        
        // 切换待办完成状态
        function toggleTodo(id) {
            const item = todoItems.find(todo => todo.id === id);
            if (item) {
                item.completed = !item.completed;
                renderTodoList();
            }
        }
        
        // 更新待办数量显示
        function updateTodoCount() {
            const pendingCount = todoItems.filter(item => !item.completed).length;
            const todoStatus = document.getElementById('todoStatus');
            if (todoStatus) {
                todoStatus.textContent = `您有${pendingCount}件待办未处理`;
            }
        }
        
        // 显示添加待办表单
        function showAddTodoForm() {
            const form = document.getElementById('addTodoForm');
            if (form) {
                form.style.display = 'block';
                document.getElementById('todoTitle')?.focus();
            }
        }
        
        // 隐藏添加待办表单
        function hideAddTodoForm() {
            const form = document.getElementById('addTodoForm');
            if (form) {
                form.style.display = 'none';
                document.getElementById('todoTitle').value = '';
            }
        }
        
        // 添加新待办
        function addTodo() {
            const titleInput = document.getElementById('todoTitle');
            const tagSelect = document.getElementById('todoTag');
            const prioritySelect = document.getElementById('todoPriority');
            
            const title = titleInput?.value.trim();
            if (!title) {
                alert('请输入待办事项内容');
                return;
            }
            
            const newTodo = {
                id: Date.now(),
                text: title,
                tag: tagSelect?.value || 'work',
                priority: prioritySelect?.value || 'medium',
                completed: false,
                source: '手动添加'
            };
            
            todoItems.unshift(newTodo);
            renderTodoList();
            hideAddTodoForm();
        }
        
        // 待办筛选功能
        function filterTodos() {
            renderTodoList();
        }

        // ========== 原有轮播图功能 ==========
        
        // Banner Carousel with Thumbnails
        let currentSlide = 0;
        const slides = document.getElementById('bannerSlides');
        let thumbnails = document.querySelectorAll('.thumbnail-item');
        let totalSlides = 4;
        let autoPlayTimer = null;

        function showSlide(index) {
            currentSlide = index;
            const slideWidth = document.querySelector('.banner-main').offsetWidth;
            slides.style.transform = `translateX(-${index * 100}%)`;
            
            thumbnails.forEach((thumb, i) => {
                thumb.classList.toggle('active', i === index);
            });
        }

        // 绑定缩略图事件
        function bindThumbnailEvents() {
            thumbnails = document.querySelectorAll('.thumbnail-item');
            thumbnails.forEach((thumbnail, index) => {
                thumbnail.addEventListener('mouseenter', () => {
                    clearInterval(autoPlayTimer);
                    showSlide(index);
                });
                
                thumbnail.addEventListener('mouseleave', () => {
                    startAutoPlay();
                });
            });
        }
        
        // 初始绑定缩略图事件
        bindThumbnailEvents();

        // Optional: Auto play (can be removed if you want manual control only)
        function startAutoPlay() {
            clearInterval(autoPlayTimer);
            autoPlayTimer = setInterval(() => {
                currentSlide = (currentSlide + 1) % totalSlides;
                showSlide(currentSlide);
            }, 5000);
        }
        
        // Start autoplay on load
        startAutoPlay();

        // Quotes Carousel Data and Logic
        let quotesData = [
            {
                text: '<span class="quote-highlight">专注、极致、口碑、快</span>，这是我们做产品的一贯原则，也是我们做人的准则。',
                author: '金山集团CEO，雷军'
            },
            {
                text: '技术创新是企业发展的核心动力，<span class="quote-highlight">让云计算成为企业发展新动力</span>，这是我们的使命。',
                author: '金山云CEO，邹涛'
            },
            {
                text: '用户的需求就是我们的追求，<span class="quote-highlight">客户成功才是真正的成功</span>，这是我们服务的初心。',
                author: '金山云CTO，钱一峰'
            },
            {
                text: '<span class="quote-highlight">以奋斗者为本</span>，让每一位员工都能在金山云实现自我价值，这是我们的人才理念。',
                author: '金山云CHO，李英'
            },
            {
                text: '创新不是闭门造车，而是<span class="quote-highlight">与客户共创、与伙伴共赢</span>，这是我们的合作理念。',
                author: '金山云副总裁，王育林'
            },
            {
                text: '<span class="quote-highlight">品质源于细节</span>，每一行代码都承载着我们对客户的承诺。',
                author: '金山云研发总监，张明'
            },
            {
                text: '在AI时代，<span class="quote-highlight">拥抱变化、持续学习</span>是我们的核心竞争力。',
                author: '金山云AI负责人，刘晓光'
            },
            {
                text: '企业文化不是口号，而是<span class="quote-highlight">每个人每天的行动</span>，这是我们的文化传承。',
                author: '金山云文化委员会'
            }
        ];

        let currentQuoteIndex = 0;
        
        function initQuotesCarousel() {
            renderCurrentQuote();
            generateQuoteIndicators();
            
            // Auto rotate quotes
            setInterval(() => {
                currentQuoteIndex = (currentQuoteIndex + 1) % quotesData.length;
                renderCurrentQuote();
                updateQuoteIndicators();
            }, 6000); // Change every 6 seconds
        }

        function renderCurrentQuote() {
            const quotesSlides = document.getElementById('quotesSlides');
            if (!quotesSlides) return;
            
            const currentQuote = quotesData[currentQuoteIndex];
            
            quotesSlides.innerHTML = `
                <div class="quote-item">
                    <div class="quote-text">${currentQuote.text}</div>
                    <div class="quote-author">${currentQuote.author}</div>
                </div>
            `;
        }

        function generateQuoteIndicators() {
            const indicatorsContainer = document.getElementById('quotesIndicators');
            if (!indicatorsContainer) return;
            
            indicatorsContainer.innerHTML = quotesData.map((_, index) => `
                <div class="quotes-indicator ${index === 0 ? 'active' : ''}" onclick="goToQuote(${index})"></div>
            `).join('');
        }

        function updateQuoteIndicators() {
            const indicators = document.querySelectorAll('.quotes-indicator');
            indicators.forEach((indicator, index) => {
                indicator.classList.toggle('active', index === currentQuoteIndex);
            });
        }

        function goToQuote(index) {
            currentQuoteIndex = index;
            renderCurrentQuote();
            updateQuoteIndicators();
        }

        function nextQuote() {
            currentQuoteIndex = (currentQuoteIndex + 1) % quotesData.length;
            renderCurrentQuote();
            updateQuoteIndicators();
        }

        function previousQuote() {
            currentQuoteIndex = (currentQuoteIndex - 1 + quotesData.length) % quotesData.length;
            renderCurrentQuote();
            updateQuoteIndicators();
        }

        // Knowledge Sharing Center Data and Logic
        const knowledgeCenterData = {
            all: [
                {
                    title: 'Claude AI 实践指南',
                    desc: '从入门到精通，全面掌握Claude AI的使用技巧',
                    icon: '灯泡.svg',
                    type: '教程',
                    views: '1.2k',
                    category: 'tutorials'
                },
                {
                    title: '云原生架构设计文档',
                    desc: '微服务架构设计原则和最佳实践',
                    icon: '图表.svg',
                    type: '文档',
                    views: '856',
                    category: 'docs'
                },
                {
                    title: 'JavaScript 性能优化技巧',
                    desc: '前端性能优化的实战技巧和工具',
                    icon: '灯泡.svg',
                    type: '教程',
                    views: '2.1k',
                    category: 'tutorials'
                },
                {
                    title: '数据库设计规范',
                    desc: 'MySQL和Redis数据库设计最佳实践',
                    icon: '图表.svg',
                    type: '文档',
                    views: '687',
                    category: 'docs'
                },
                {
                    title: 'AI工具集合',
                    desc: '精选的AI工具和资源合集',
                    icon: '文件夹.svg',
                    type: '资源',
                    views: '3.5k',
                    category: 'resources'
                },
                {
                    title: '代码审查清单',
                    desc: '代码审查的标准和清单指南',
                    icon: '文件夹.svg',
                    type: '资源',
                    views: '945',
                    category: 'resources'
                }
            ],
            docs: [
                {
                    title: '云原生架构设计文档',
                    desc: '微服务架构设计原则和最佳实践',
                    icon: '图表.svg',
                    type: '文档',
                    views: '856',
                    category: 'docs'
                },
                {
                    title: '数据库设计规范',
                    desc: 'MySQL和Redis数据库设计最佳实践',
                    icon: '图表.svg',
                    type: '文档',
                    views: '687',
                    category: 'docs'
                }
            ],
            tutorials: [
                {
                    title: 'Claude AI 实践指南',
                    desc: '从入门到精通，全面掌握Claude AI的使用技巧',
                    icon: '灯泡.svg',
                    type: '教程',
                    views: '1.2k',
                    category: 'tutorials'
                },
                {
                    title: 'JavaScript 性能优化技巧',
                    desc: '前端性能优化的实战技巧和工具',
                    icon: '灯泡.svg',
                    type: '教程',
                    views: '2.1k',
                    category: 'tutorials'
                }
            ],
            resources: [
                {
                    title: 'AI工具集合',
                    desc: '精选的AI工具和资源合集',
                    icon: '文件夹.svg',
                    type: '资源',
                    views: '3.5k',
                    category: 'resources'
                },
                {
                    title: '代码审查清单',
                    desc: '代码审查的标准和清单指南',
                    icon: '文件夹.svg',
                    type: '资源',
                    views: '945',
                    category: 'resources'
                }
            ]
        };

        function switchCenterTab(event, tab) {
            const tabs = document.querySelectorAll('.center-tab');
            tabs.forEach(t => t.classList.remove('active'));
            
            if (event && event.target) {
                event.target.classList.add('active');
            }

            const container = document.getElementById('centerContent');
            if (!container) return;
            
            const knowledgeItems = knowledgeCenterData[tab] || knowledgeCenterData.all;
            
            container.innerHTML = knowledgeItems.map(item => `
                <div class="knowledge-item">
                    <div class="knowledge-item-icon">
                        <img src="icon/${item.icon}" alt="${item.title}">
                    </div>
                    <div class="knowledge-item-content">
                        <div class="knowledge-item-title">${item.title}</div>
                        <div class="knowledge-item-desc">${item.desc}</div>
                    </div>
                    <div class="knowledge-item-meta">
                        <div class="knowledge-item-type">${item.type}</div>
                        <div class="knowledge-item-views">${item.views} 次查看</div>
                    </div>
                </div>
            `).join('');
        }

        // AI Tools Data
        const aiToolsData = {
            recommended: [
                { logo: '3.png', name: 'WPS AI', desc: '智能办公助手', tag: '最近使用' },
                { logo: '15.png', name: 'ChatGPT', desc: '智能对话助手', tag: '热门' },
                { logo: '2.png', name: 'Claude Code', desc: 'AI编程助手', tag: '更新' },
                { logo: '11.png', name: '即梦', desc: 'AI图片创作', tag: '热门' },
                { logo: '19.png', name: 'Copilot', desc: 'AI编程助手', tag: '最近使用' },
                { logo: '7.png', name: '会议纪要', desc: 'AI自动生成纪要', tag: '更新' },
                { logo: '12.png', name: 'Midjourney', desc: 'AI艺术创作', tag: '热门' }
            ],
            office: [
                { logo: '3.png', name: 'WPS AI', desc: '智能办公助手' },
                { logo: '7.png', name: '会议纪要', desc: 'AI自动生成纪要' },
                { logo: '4.png', name: 'Notion AI', desc: '智能笔记工具' },
                { logo: '8.png', name: 'PPT助手', desc: '演示文稿生成' }
            ],
            general: [
                { logo: '11.png', name: '即梦', desc: '免费AI图片创作' },
                { logo: '15.png', name: 'ChatGPT', desc: '智能对话助手' },
                { logo: '12.png', name: 'Midjourney', desc: 'AI艺术创作' },
                { logo: '16.png', name: 'Claude', desc: 'AI智能助理' }
            ],
            code: [
                { logo: '19.png', name: 'Copilot', desc: 'AI编程助手' },
                { logo: '22.png', name: 'Tabnine', desc: '代码自动补全' },
                { logo: '20.png', name: 'Cursor', desc: 'AI代码编辑器' },
                { logo: '23.png', name: 'CodeT5', desc: '代码生成工具' }
            ]
        };

        // Switch AI Tools - Right Column
        function switchAITools(event, tab) {
            const tabs = document.querySelectorAll('.ai-tools-tab');
            tabs.forEach(t => t.classList.remove('active'));
            
            // 如果event为null（初始化时），需要手动设置第一个tab为active
            if (event && event.target) {
                event.target.classList.add('active');
            } else if (tab === 'recent') {
                // 初始化时，设置第一个tab（推荐）为active
                const firstTab = document.querySelector('.ai-tools-tab');
                if (firstTab) {
                    firstTab.classList.add('active');
                }
            }

            const container = document.getElementById('aiToolsGrid');
            if (!container) {
                console.log('Container not found');
                return;
            }
            
            let tools = [];
            
            // 根据不同tab显示不同工具，最近使用的在前面
            if (tab === 'recent') {
                // 确保使用recommended数据，而不是office数据
                if (aiToolsData.recommended && aiToolsData.recommended.length > 0) {
                    const recentTools = aiToolsData.recommended.filter(t => t.tag === '最近使用');
                    const hotTools = aiToolsData.recommended.filter(t => t.tag === '热门');
                    tools = [...recentTools, ...hotTools.slice(0, 6)];
                    
                    // 如果筛选后为空，使用所有recommended工具
                    if (tools.length === 0) {
                        tools = aiToolsData.recommended;
                    }
                } else {
                    // 如果recommended不存在，创建默认的推荐工具
                    tools = [
                        { logo: '3.png', name: 'WPS AI', desc: '智能办公助手', tag: '最近使用' },
                        { logo: '15.png', name: 'ChatGPT', desc: '智能对话助手', tag: '热门' },
                        { logo: '2.png', name: 'Claude Code', desc: 'AI编程助手', tag: '更新' },
                        { logo: '11.png', name: '即梦', desc: 'AI图片创作', tag: '热门' },
                        { logo: '19.png', name: 'Copilot', desc: 'AI编程助手', tag: '最近使用' },
                        { logo: '7.png', name: '会议纪要', desc: 'AI自动生成纪要', tag: '更新' }
                    ];
                }
            } else if (tab === 'hot') {
                if (aiToolsData.recommended) {
                    tools = aiToolsData.recommended.filter(t => t.tag === '热门' || t.tag === '更新');
                } else {
                    tools = aiToolsData.office || [];
                }
            } else {
                tools = aiToolsData[tab] || aiToolsData.office || [];
            }
            
            // 限制显示数量为9个，符合3x3布局
            tools = tools.slice(0, 9);
            
            console.log(`Switching to tab: ${tab}, tools count: ${tools.length}, first tool:`, tools[0]);
            
            container.innerHTML = tools.map(tool => `
                <div class="ai-tool-item" onclick="window.location.href='tool-detail.html'" style="cursor: pointer;">
                    <div class="ai-tool-logo">
                        <img src="logo/${tool.logo}" alt="${tool.name}">
                    </div>
                    <div class="ai-tool-name">${tool.name}</div>
                    ${tool.tag ? `<div class="ai-tool-tag ${tool.tag === '最近使用' ? 'recent' : 'hot'}">${tool.tag === '最近使用' ? '最近' : tool.tag}</div>` : ''}
                </div>
            `).join('');
        }

        // Switch AI Tools TouchBar (Legacy - keeping for compatibility)
        function switchAITouchBar(event, tab) {
            const tabs = document.querySelectorAll('.touchbar-tab');
            tabs.forEach(t => t.classList.remove('active'));
            if (event && event.target) {
                event.target.classList.add('active');
            }

            const container = document.getElementById('touchbarTools');
            if (!container) return; // Container no longer exists
            
            let tools;
            
            // 根据不同tab显示不同工具，最近使用的在前面
            if (tab === 'recent') {
                tools = [
                    ...aiToolsData.recommended.filter(t => t.tag === '最近使用'),
                    ...aiToolsData.recommended.filter(t => t.tag === '热门').slice(0, 3)
                ];
            } else if (tab === 'hot') {
                tools = aiToolsData.recommended.filter(t => t.tag === '热门' || t.tag === '更新');
            } else {
                tools = aiToolsData[tab] || aiToolsData.office;
            }
            
            container.innerHTML = tools.map(tool => `
                <div class="touchbar-tool">
                    <div class="touchbar-tool-logo">
                        <img src="logo/${tool.logo}" alt="${tool.name}">
                    </div>
                    <div class="touchbar-tool-name">${tool.name}</div>
                    ${tool.tag ? `<div class="touchbar-tool-tag ${tool.tag === '最近使用' ? 'recent' : 'hot'}">${tool.tag}</div>` : ''}
                </div>
            `).join('');
        }
        
        // Switch AI Tools Tab - Horizontal Bar (Legacy)
        function switchAITabBar(event, tab) {
            const tabs = document.querySelectorAll('.ai-tab');
            tabs.forEach(t => t.classList.remove('active'));
            if (event && event.target) {
                event.target.classList.add('active');
            }

            const list = document.getElementById('aiToolsHorizontalList');
            if (!list) return;
            const tools = aiToolsData[tab];
            
            list.innerHTML = tools.map(tool => `
                <div class="ai-tool-horizontal">
                    <div class="ai-tool-logo">
                        <img src="logo/${tool.logo}" alt="${tool.name}">
                    </div>
                    <div class="ai-tool-info">
                        <div class="ai-tool-name">${tool.name}</div>
                        <div class="ai-tool-desc">${tool.desc}</div>
                    </div>
                    ${tool.tag ? `<div class="ai-tool-tag">${tool.tag}</div>` : ''}
                </div>
            `).join('');
        }

        // Switch AI Tools Tab - Legacy (keeping for compatibility)
        function switchAITab(event, tab) {
            const tabs = document.querySelectorAll('.module-card:nth-child(1) .module-tab');
            tabs.forEach(t => t.classList.remove('active'));
            if (event && event.target) {
                event.target.classList.add('active');
            }

            const grid = document.getElementById('aiToolsGrid');
            if (!grid) return;
            const tools = aiToolsData[tab];
            
            grid.innerHTML = tools.map(tool => `
                <div class="ai-tool-card">
                    <div class="ai-tool-logo">
                        <img src="logo/${tool.logo}" alt="${tool.name}">
                    </div>
                    <div class="ai-tool-info">
                        <div class="ai-tool-name">${tool.name}</div>
                        <div class="ai-tool-desc">${tool.desc}</div>
                    </div>
                </div>
            `).join('');
        }

        // Forum Data - Extended for card layout
        const forumDataFull = {
            hot: [
                { 
                    id: 'forum1',
                    title: '云原生架构最佳实践分享', 
                    content: '基于多年的云原生项目经验，分享一些K8s和Docker在生产环境中的优化经验和踩坑指南。',
                    time: '2小时前', 
                    views: '1.2k', 
                    likes: '256',
                    replies: '45',
                    tag: '知识',
                    tagColor: '#4CAF50'
                },
                { 
                    id: 'forum2',
                    title: '周末有一起爬山的吗？', 
                    content: '天气不错，想约几个同事一起去爬山，有兴趣的可以一起，路线不累，适合新手。',
                    time: '3小时前', 
                    views: '445', 
                    likes: '95',
                    replies: '18',
                    tag: '生活',
                    tagColor: '#FF9800'
                },
                { 
                    id: 'forum3',
                    title: '微服务设计模式讨论', 
                    content: '在微服务架构中，如何合理划分服务边界？大家都有哪些经验和见解？',
                    time: '1天前', 
                    views: '2.1k', 
                    likes: '342',
                    replies: '67',
                    tag: '技术',
                    tagColor: '#2196F3'
                },
                { 
                    id: 'forum4',
                    title: 'AI工具在日常工作中的应用', 
                    content: '整理了一些AI工具在日常工作中的实用场景，包括文档写作、代码审查等。',
                    time: '1天前', 
                    views: '1.8k', 
                    likes: '298',
                    replies: '34',
                    tag: '工具',
                    tagColor: '#9C27B0'
                },
                { 
                    title: '新员工入职流程咨询', 
                    content: '刚入职的新人，想了解一下公司的各种流程和系统，请问有新人手册吗？',
                    time: '2天前', 
                    views: '578', 
                    likes: '89',
                    replies: '23',
                    tag: '文化',
                    tagColor: '#E91E63'
                },
                { 
                    title: '健身房办卡可以拼单吗', 
                    content: '想办个健身房年卡，看看有没有同事一起，可以拼单优惠一些，主要想锻炼身体。',
                    time: '2天前', 
                    views: '389', 
                    likes: '67',
                    replies: '14',
                    tag: '生活',
                    tagColor: '#FF9800'
                }
            ],
            latest: [
                { 
                    id: 'forum5',
                    title: '如何申请远程办公？', 
                    content: '想了解一下公司远程办公的申请流程和条件，有经验的同事可以分享一下吗？',
                    time: '30分钟前', 
                    views: '234', 
                    likes: '45',
                    replies: '8'
                },
                { 
                    id: 'forum6',
                    title: '新员工入职流程咨询', 
                    content: '刚入职的新人，想了解一下公司的各种流程和系统，请问有新人手册吗？',
                    time: '1小时前', 
                    views: '445', 
                    likes: '78',
                    replies: '12'
                },
                { 
                    id: 'forum7',
                    title: '出闲置4060ti显卡，99新', 
                    content: '最近升级了显卡，闲置一张4060ti，99新，原盒包装都在，有需要的同事可以私信。',
                    time: '2小时前', 
                    views: '567', 
                    likes: '128',
                    replies: '15'
                },
                { 
                    id: 'forum8',
                    title: '报销系统使用问题', 
                    content: '最近使用报销系统遇到一些问题，上传的发票图片总是识别不了，有同事遇到过吗？',
                    time: '3小时前', 
                    views: '332', 
                    likes: '67',
                    replies: '9'
                }
            ],
            knowledge: [
                { 
                    id: 'forum9',
                    title: '深度学习模型优化经验', 
                    content: '分享一些在模型训练和推理优化方面的实战经验，包括参数调优和模型压缩。',
                    time: '5小时前', 
                    views: '923', 
                    likes: '245',
                    replies: '38'
                },
                { 
                    title: '数据库性能调优实践', 
                    content: 'MySQL和PostgreSQL在高并发场景下的性能调优经验分享，包括索引优化和查询优化。',
                    time: '8小时前', 
                    views: '1.1k', 
                    likes: '189',
                    replies: '29'
                },
                { 
                    title: 'React性能优化最佳实践', 
                    content: '总结了一些React项目中常见的性能问题和解决方案，包括memo、useMemo等hook的正确使用。',
                    time: '12小时前', 
                    views: '756', 
                    likes: '167',
                    replies: '21'
                },
                { 
                    title: '前端工程化工具链配置', 
                    content: '分享一个完整的前端项目工程化配置，包括Webpack、ESLint、Prettier等工具的最优配置。',
                    time: '1天前', 
                    views: '634', 
                    likes: '143',
                    replies: '17'
                }
            ],
            life: [
                { 
                    id: 'forum13',
                    title: '周末有一起爬山的吗？', 
                    content: '天气不错，想约几个同事一起去爬山，有兴趣的可以一起，路线不累，适合新手。',
                    time: '3小时前', 
                    views: '445', 
                    likes: '95',
                    replies: '18'
                },
                { 
                    title: '健身房办卡可以拼单吗', 
                    content: '想办个健身房年卡，看看有没有同事一起，可以拼单优惠一些，主要想锻炼身体。',
                    time: '6小时前', 
                    views: '389', 
                    likes: '67',
                    replies: '14'
                },
                { 
                    title: '推荐一个附近的美食店', 
                    content: '最近发现公司附近新开了一家川菜馆，味道不错价格实惠，推荐给大家。',
                    time: '1天前', 
                    views: '623', 
                    likes: '156',
                    replies: '28'
                },
                { 
                    title: '有人组队打羽毛球吗', 
                    content: '想找几个同事一起打羽毛球，公司附近就有场地，下班后或者周末都可以。',
                    time: '2天前', 
                    views: '298', 
                    likes: '45',
                    replies: '11'
                }
            ]
        };
        
        // Forum Data - Legacy
        const forumData = {
            knowledge: [
                { title: '云原生架构最佳实践分享', time: '2小时前', heat: '256' },
                { title: 'K8S集群优化经验总结', time: '5小时前', heat: '189' },
                { title: '微服务设计模式讨论', time: '1天前', heat: '342' }
            ],
            life: [
                { title: '出闲置4060ti显卡，99新', time: '3小时前', heat: '128' },
                { title: '周末有一块爬山的吗', time: '6小时前', heat: '95' },
                { title: '健身打卡小组招募', time: '2天前', heat: '67' }
            ],
            qa: [
                { title: '如何申请远程办公？', time: '1小时前', heat: '45' },
                { title: '新员工入职流程咨询', time: '4小时前', heat: '78' },
                { title: '报销系统使用问题', time: '1天前', heat: '156' }
            ]
        };

        // Switch Forum Tab - Full Width Cards
        function switchForumTabFull(event, tab) {
            const tabs = document.querySelectorAll('.forum-tab');
            tabs.forEach(t => t.classList.remove('active'));
            
            // 如果event为null（初始化时），需要手动设置对应tab为active
            if (event && event.target) {
                event.target.classList.add('active');
            } else {
                // 初始化时，根据tab参数设置对应的tab为active
                const targetTab = document.querySelector(`.forum-tab[onmouseover*="'${tab}'"]`);
                if (targetTab) {
                    targetTab.classList.add('active');
                }
            }

            const grid = document.getElementById('forumCardsGrid');
            const items = forumDataFull[tab];
            
            grid.innerHTML = items.map(item => `
                <div class="forum-card" onclick="window.location.href='论坛/forum-post-detail.html?id=${item.id || encodeURIComponent(item.title)}'">
                    <div class="forum-card-header">
                        <div class="forum-card-title">${item.title}</div>
                        ${item.tag ? `<div class="forum-card-tag" style="background-color: ${item.tagColor}">${item.tag}</div>` : ''}
                    </div>
                    <div class="forum-card-content">${item.content}</div>
                    <div class="forum-card-meta">
                        <div class="forum-card-meta-left">
                            <div class="forum-meta-item">
                                <img src="icon/日期.png" alt="时间">
                                <span>${item.time}</span>
                            </div>
                        </div>
                        <div class="forum-card-meta-right">
                            <div class="forum-meta-item">
                                <img src="icon/浏览.png" alt="浏览">
                                <span>${item.views}</span>
                            </div>
                            <div class="forum-meta-item">
                                <img src="icon/点赞.png" alt="点赞">
                                <span>${item.likes}</span>
                            </div>
                            <div class="forum-meta-item">
                                <img src="icon/评论.svg" alt="评论">
                                <span>${item.replies}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        // Switch Forum Tab - Legacy
        function switchForumTab(event, tab) {
            const tabs = document.querySelectorAll('.module-card .module-tab');
            tabs.forEach(t => t.classList.remove('active'));
            if (event && event.target) {
                event.target.classList.add('active');
            }

            const list = document.getElementById('forumList');
            if (!list) return;
            const items = forumData[tab];
            
            list.innerHTML = items.map(item => `
                <div class="forum-item">
                    <div class="forum-title">${item.title}</div>
                    <div class="forum-meta">
                        <span><img src="icon/日期.png" style="width: 12px; height: 12px;"> ${item.time}</span>
                        <span><img src="icon/浏览.png" style="width: 12px; height: 12px;"> ${item.heat}热度</span>
                    </div>
                </div>
            `).join('');
        }

        // Enterprise Information Forum Data
        const knowledgeData = {
            all: [
                { name: 'Claude Code 2.0重大更新：AI编程新纪元', category: '技术洞察', time: '2025-01-20', views: '3.2k' },
                { name: '《时光相册》金山云十周年特辑', category: '文化长廊', time: '2025-01-20', views: '2.8k' },
                { name: '金山云获评“2024年度最佳云服务提供商”', category: '公司大事', time: '2025-01-19', views: '4.5k' },
                { name: 'AI日报20250822，深度学习框架的未来', category: '技术洞察', time: '2025-01-19', views: '1.9k' },
                { name: '《生生不息》第五季：从云计算到AI时代', category: '文化长廊', time: '2025-01-18', views: '3.1k' },
                { name: '年度技术分享大会成功举办', category: '公司大事', time: '2025-01-18', views: '2.4k' }
            ],
            tech: [
                { name: 'Claude Code 2.0重大更新：AI编程新纪元', category: '技术洞察', time: '2025-01-20', views: '3.2k' },
                { name: 'K8s集群优化实践：提升80%资源利用率', category: '技术洞察', time: '2025-01-19', views: '1.9k' },
                { name: '大模型推理优化：响应速度提升10倍', category: '技术洞察', time: '2025-01-17', views: '2.2k' },
                { name: '分布式存储架构演进之路', category: '技术洞察', time: '2025-01-16', views: '1.5k' },
                { name: 'Rust在云基础设施中的应用实践', category: '技术洞察', time: '2025-01-15', views: '1.8k' },
                { name: 'WebAssembly在边缘计算中的创新应用', category: '技术洞察', time: '2025-01-14', views: '1.3k' }
            ],
            culture: [
                { name: '《时光相册》金山云十周年特辑', category: '文化长廊', time: '2025-01-20', views: '2.8k' },
                { name: '《生生不息》第五季：从云计算到AI时代', category: '文化长廊', time: '2025-01-18', views: '3.1k' },
                { name: '人物故事：从实习生到技术专家的成长之路', category: '文化长廊', time: '2025-01-17', views: '2.5k' },
                { name: '云耀故事：那些年我们一起奋斗的日子', category: '文化长廊', time: '2025-01-16', views: '2.9k' },
                { name: '《故事集》第十期：创新精神传承', category: '文化长廊', time: '2025-01-15', views: '2.2k' },
                { name: '金山云发展历程回顾：梦想照进现实', category: '文化长廊', time: '2025-01-14', views: '3.4k' }
            ],
            company: [
                { name: '金山云获评“2024年度最佳云服务提供商”', category: '公司大事', time: '2025-01-19', views: '4.5k' },
                { name: '年度技术分享大会成功举办', category: '公司大事', time: '2025-01-18', views: '2.4k' },
                { name: '新一代AI平台2.0正式发布', category: '公司大事', time: '2025-01-17', views: '3.8k' },
                { name: '金山云与华为达成战略合作', category: '公司大事', time: '2025-01-16', views: '5.2k' },
                { name: '春节团建活动报名开启', category: '公司大事', time: '2025-01-15', views: '1.8k' },
                { name: 'Q1季度业绩创新高，同比增长45%', category: '公司大事', time: '2025-01-14', views: '3.3k' }
            ]
        };

        // Switch Knowledge Tab
        function switchKnowledgeTab(event, tab) {
            const tabs = document.querySelectorAll('.knowledge-tab');
            tabs.forEach(t => t.classList.remove('active'));
            
            // 如果event为null（初始化时），需要手动设置对应tab为active
            if (event && event.target) {
                event.target.classList.add('active');
            } else {
                // 初始化时，根据tab参数设置对应的tab为active
                const targetTab = document.querySelector(`.knowledge-tab[onmouseover*="'${tab}'"]`);
                if (targetTab) {
                    targetTab.classList.add('active');
                }
            }

            const list = document.getElementById('knowledgeList');
            const items = knowledgeData[tab];
            
            list.innerHTML = items.map(item => `
                <div class="knowledge-item" onclick="window.location.href='论坛/forum-news-vote-detail.html'" style="cursor: pointer;">
                    <div class="knowledge-info">
                        <div class="knowledge-name">${item.name}</div>
                        <div class="knowledge-meta">
                            <span>${item.category}</span>
                            <span><img src="icon/日期.png" style="width: 12px; height: 12px;"> ${item.time}</span>
                            <span><img src="icon/浏览.png" style="width: 12px; height: 12px;"> ${item.views}</span>
                        </div>
                    </div>
                    <div class="knowledge-arrow">→</div>
                </div>
            `).join('');
        }

        // Dynamic Cards functionality removed

        // Ranking Data
        const rankingData = {
            likes: {
                title: '排行榜',
                subtitle: '赞一赞月排名',
                icon: 'icon/点赞.png',
                users: [
                    { name: '张秋实', department: '技术委员会', avatar: '头像/张秋实-技术委员会.png', score: 1234, hasGoldBadge: true },
                    { name: '赵小萱', department: '技术委员会', avatar: '头像/赵小萱-技术委员会.png', score: 986, hasGoldBadge: false },
                    { name: '高通', department: '组织和人力资源', avatar: '头像/高通-组织和人力资源.jpg', score: 856, hasGoldBadge: false },
                    { name: '李浩泽', department: '技术委员会', avatar: '头像/李浩泽-技术委员会.png', score: 743, hasGoldBadge: false }
                ]
            },
            learning: {
                title: '排行榜',
                subtitle: '学习积分月排名',
                icon: 'icon/学习积分.png',
                users: [
                    { name: '李盛菲', department: '公有云', avatar: '头像/李盛菲-公有云.png', score: 2340, hasGoldBadge: true },
                    { name: '胡晓晓', department: '技术研发部', avatar: '头像/胡晓晓-技术研发部.jpg', score: 2156, hasGoldBadge: false },
                    { name: '陈昱龙', department: '政企事业部', avatar: '头像/陈昱龙-政企事业部.jpg', score: 1987, hasGoldBadge: false },
                    { name: '韩博', department: '技术委员会', avatar: '头像/韩博-技术委员会.png', score: 1834, hasGoldBadge: false }
                ]
            }
        };

        // Switch Ranking
        function switchRanking(event, type) {
            const tabs = document.querySelectorAll('.ranking-tab');
            tabs.forEach(t => t.classList.remove('active'));
            
            // 如果event为null（初始化时），需要手动设置对应tab为active
            if (event && event.target.closest('.ranking-tab')) {
                event.target.closest('.ranking-tab').classList.add('active');
            } else if (type === 'likes') {
                // 初始化时，设置点赞tab为active
                const likesTab = document.querySelector('.ranking-tab');
                if (likesTab) {
                    likesTab.classList.add('active');
                }
            } else if (type === 'learning') {
                // 初始化时，设置学习tab为active
                const learningTab = document.querySelectorAll('.ranking-tab')[1];
                if (learningTab) {
                    learningTab.classList.add('active');
                }
            }

            const data = rankingData[type];
            const module = document.querySelector('.ranking-module');
            
            // Update module class for background icon
            module.className = 'ranking-module';
            if (type === 'learning') {
                module.classList.add('learning');
            }
            
            // Update title and icon
            document.getElementById('rankingTitle').textContent = data.title;
            document.getElementById('rankingSubtitle').textContent = data.subtitle;
            document.getElementById('rankingIcon').src = data.icon;
            
            // Update ranking list
            const rankingList = document.querySelector('.ranking-list');
            rankingList.innerHTML = data.users.map((user, index) => `
                <div class="ranking-item">
                    <div class="ranking-number">${index + 1}</div>
                    <div class="ranking-avatar" onclick="window.location.href='user-profile.html'" style="cursor: pointer;">
                        <img src="${user.avatar}" alt="${user.name}">
                        ${user.hasGoldBadge ? `
                            <div class="gold-needle-badge">
                                <img src="icon/金指针.png" alt="金指针">
                            </div>
                        ` : ''}
                    </div>
                    <div class="ranking-info">
                        <div class="ranking-user-info">
                            <div class="ranking-name">
                                ${user.name}
                                ${user.hasGoldBadge ? '<span class="gold-needle-text">金指针</span>' : ''}
                            </div>
                            <div class="ranking-department">${user.department}</div>
                        </div>
                    </div>
                    <div class="ranking-likes">
                        <img src="${data.icon}" alt="${type === 'likes' ? '点赞' : '学习积分'}">
                        <span>${user.score.toLocaleString()}</span>
                    </div>
                </div>
            `).join('');
        }

        // Hide notification function
        function hideNotification(notificationId) {
            const notification = document.getElementById(notificationId);
            if (notification) {
                notification.classList.add('hidden');
            }
        }

        // Initialize modules with default content
        window.addEventListener('DOMContentLoaded', () => {
            // 方法2：直接调用渲染函数，确保内容正确加载
            switchAITools(null, 'recent');
            
            // 同时也主动触发一次事件，确保双重保障
            setTimeout(() => {
                const defaultTab = document.querySelector('.ai-tools-tab');
                if (defaultTab) {
                    // 模拟鼠标悬停事件
                    const mouseOverEvent = new MouseEvent('mouseover', {
                        bubbles: true,
                        cancelable: true,
                        view: window
                    });
                    defaultTab.dispatchEvent(mouseOverEvent);
                }
            }, 50);
            
            // Initialize other modules
            // Initialize AI Tools TouchBar (Legacy - only if container exists)
            switchAITouchBar(null, 'recent');
            // Initialize AI Tools Bar (Legacy)
            switchAITabBar(null, 'recommended');
            // Initialize AI Tools (legacy)
            switchAITab(null, 'office');
            // Initialize Forum Full
            switchForumTabFull(null, 'hot');
            // Initialize Forum (legacy)
            switchForumTab(null, 'knowledge');
            // Initialize Knowledge Base
            switchKnowledgeTab(null, 'all');
            // Initialize Knowledge Sharing Center
            switchCenterTab(null, 'all');
            // Initialize Ranking Module
            switchRanking(null, 'likes');
            // Initialize Quotes Carousel
            initQuotesCarousel();
        });

        // Global Search Functionality
        const searchData = {
            news: [
                {
                    title: 'Claude Code 2.0重大更新发布',
                    desc: 'Anthropic发布Claude Code 2.0版本，带来更强大的代码生成能力和IDE集成功能，支持更多编程语言和框架。',
                    author: '技术资讯部',
                    time: '2小时前',
                    views: '3.2k'
                },
                {
                    title: '使用Claude Code提升开发效率的10个技巧',
                    desc: '深入了解如何充分利用Claude Code的各项功能，包括代码补全、重构建议、测试生成等高级特性。',
                    author: '开发者社区',
                    time: '1天前',
                    views: '5.8k'
                },
                {
                    title: 'Claude Code vs GitHub Copilot 深度对比',
                    desc: '从功能、性能、价格等多个维度全面对比两大AI编程助手，帮助开发者选择最适合的工具。',
                    author: '产品评测',
                    time: '3天前',
                    views: '8.1k'
                }
            ],
            forum: [
                {
                    title: '有没有哪位大哥借我一个Claude Code账号',
                    desc: '想体验一下Claude Code的功能，看看是否值得购买订阅。有愿意分享体验账号的朋友吗？',
                    author: '张三',
                    time: '5小时前',
                    replies: '23',
                    likes: '156'
                },
                {
                    title: 'Claude Code在VSCode中的配置教程',
                    desc: '分享一下我在VSCode中配置Claude Code的详细步骤，包括快捷键设置和工作流优化。',
                    author: '李四',
                    time: '12小时前',
                    replies: '45',
                    likes: '289'
                },
                {
                    title: '分享：用Claude Code重构老项目的经验',
                    desc: '最近用Claude Code帮助重构了一个5年前的老项目，分享一些心得和遇到的坑。',
                    author: '王五',
                    time: '2天前',
                    replies: '67',
                    likes: '512'
                },
                {
                    title: 'Claude Code生成的代码质量讨论',
                    desc: '大家觉得Claude Code生成的代码质量如何？有哪些需要特别注意的地方？',
                    author: '赵六',
                    time: '3天前',
                    replies: '89',
                    likes: '423'
                }
            ],
            tools: [
                {
                    name: 'Claude Code',
                    logo: 'logo/2.png',
                    desc: 'Anthropic官方AI编程助手，支持多种编程语言，提供智能代码补全和重构建议',
                    badge: '官方推荐',
                    users: '50k+'
                },
                {
                    name: 'Claude Code Extension Pack',
                    logo: 'logo/2.png',
                    desc: 'VSCode扩展包，包含Claude Code核心功能和相关工具集成',
                    badge: '热门',
                    users: '32k+'
                },
                {
                    name: 'Claude Code API',
                    logo: 'logo/2.png',
                    desc: '开发者API接口，支持在自定义应用中集成Claude Code功能',
                    badge: '开发者',
                    users: '12k+'
                }
            ],
            docs: [
                {
                    title: 'Claude Code快速入门指南',
                    desc: '从零开始学习Claude Code，包含安装、配置、基础使用等内容。适合新手入门。',
                    category: '入门教程',
                    updateTime: '2025-01-19',
                    readTime: '15分钟'
                },
                {
                    title: 'Claude Code高级功能详解',
                    desc: '深入探讨Claude Code的高级特性，包括自定义模板、工作流自动化、团队协作等功能。',
                    category: '进阶文档',
                    updateTime: '2025-01-18',
                    readTime: '30分钟'
                },
                {
                    title: 'Claude Code API参考文档',
                    desc: '完整的API接口文档，包含所有可用端点、参数说明和示例代码。',
                    category: 'API文档',
                    updateTime: '2025-01-17',
                    readTime: '45分钟'
                },
                {
                    title: 'Claude Code最佳实践',
                    desc: '收集整理的Claude Code使用最佳实践，帮助开发者更高效地使用AI编程助手。',
                    category: '最佳实践',
                    updateTime: '2025-01-16',
                    readTime: '20分钟'
                }
            ]
        };

        let currentSearchTab = 'all';
        let searchQuery = '';

        // Open search overlay
        function openSearch() {
            const overlay = document.getElementById('searchOverlay');
            overlay.classList.add('active');
            document.getElementById('globalSearchInput').focus();
            document.body.style.overflow = 'hidden';
        }

        // Close search overlay
        function closeSearch() {
            const overlay = document.getElementById('searchOverlay');
            overlay.classList.remove('active');
            document.body.style.overflow = '';
            document.getElementById('globalSearchInput').value = '';
            searchQuery = '';
            updateSearchResults();
        }

        // Switch search tab
        function switchSearchTab(tab) {
            currentSearchTab = tab;
            const tabs = document.querySelectorAll('.search-tab');
            tabs.forEach(t => {
                t.classList.remove('active');
                if (t.textContent.includes(getTabName(tab))) {
                    t.classList.add('active');
                }
            });
            updateSearchResults();
        }

        function getTabName(tab) {
            const names = {
                'all': '全部',
                'news': '资讯',
                'forum': '论坛',
                'tools': '工具库',
                'docs': '知识文档'
            };
            return names[tab] || '全部';
        }

        // Highlight search term
        function highlightText(text, query) {
            if (!query) return text;
            const regex = new RegExp(`(${query})`, 'gi');
            return text.replace(regex, '<mark>$1</mark>');
        }

        // Filter search results
        function filterResults(category, query) {
            if (!searchData[category]) return [];
            
            return searchData[category].filter(item => {
                const searchFields = [
                    item.title || item.name,
                    item.desc,
                    item.author,
                    item.category
                ].filter(Boolean).join(' ').toLowerCase();
                
                return searchFields.includes(query.toLowerCase());
            });
        }

        // Update search results
        function updateSearchResults() {
            const resultsContainer = document.getElementById('searchResults');
            
            if (!searchQuery) {
                resultsContainer.innerHTML = `
                    <div class="search-empty">
                        <img src="icon/搜索.png" alt="搜索">
                        <p>输入关键词开始搜索</p>
                    </div>
                `;
                updateCounts({});
                return;
            }

            const results = {
                news: filterResults('news', searchQuery),
                forum: filterResults('forum', searchQuery),
                tools: filterResults('tools', searchQuery),
                docs: filterResults('docs', searchQuery)
            };

            updateCounts(results);

            let html = '';

            if (currentSearchTab === 'all') {
                // Show all categories
                let hasResults = false;

                // Tools
                if (results.tools.length > 0) {
                    hasResults = true;
                    results.tools.forEach(tool => {
                        html += `
                            <div class="search-tool-card">
                                <div class="search-tool-logo">
                                    <img src="${tool.logo}" alt="${tool.name}">
                                </div>
                                <div class="search-tool-info">
                                    <div class="search-tool-name">${highlightText(tool.name, searchQuery)}</div>
                                    <div class="search-tool-desc">${highlightText(tool.desc, searchQuery)}</div>
                                </div>
                                <div class="search-tool-badge">${tool.badge}</div>
                            </div>
                        `;
                    });
                }

                // Forum
                if (results.forum.length > 0) {
                    hasResults = true;
                    results.forum.forEach(post => {
                        html += `
                            <div class="search-result-item">
                                <span class="search-result-category">论坛</span>
                                <div class="search-result-title">${highlightText(post.title, searchQuery)}</div>
                                <div class="search-result-desc">${highlightText(post.desc, searchQuery)}</div>
                                <div class="search-result-meta">
                                    <span><img src="icon/用户.svg" style="width: 12px; height: 12px;" alt="用户"> ${post.author}</span>
                                    <span><img src="icon/时间.svg" style="width: 12px; height: 12px;" alt="时间"> ${post.time}</span>
                                    <span><img src="icon/评论.svg" style="width: 12px; height: 12px;" alt="评论"> ${post.replies}回复</span>
                                    <span><img src="icon/心形.svg" style="width: 12px; height: 12px;" alt="赞"> ${post.likes}赞</span>
                                </div>
                            </div>
                        `;
                    });
                }

                // News
                if (results.news.length > 0) {
                    hasResults = true;
                    results.news.forEach(article => {
                        html += `
                            <div class="search-result-item">
                                <span class="search-result-category">资讯</span>
                                <div class="search-result-title">${highlightText(article.title, searchQuery)}</div>
                                <div class="search-result-desc">${highlightText(article.desc, searchQuery)}</div>
                                <div class="search-result-meta">
                                    <span><img src="icon/作者.svg" style="width: 12px; height: 12px;" alt="作者"> ${article.author}</span>
                                    <span><img src="icon/时间.svg" style="width: 12px; height: 12px;" alt="时间"> ${article.time}</span>
                                    <span><img src="icon/浏览.png" style="width: 12px; height: 12px;" alt="浏览"> ${article.views}阅读</span>
                                </div>
                            </div>
                        `;
                    });
                }

                // Docs
                if (results.docs.length > 0) {
                    hasResults = true;
                    results.docs.forEach(doc => {
                        html += `
                            <div class="search-result-item">
                                <span class="search-result-category">知识文档</span>
                                <div class="search-result-title">${highlightText(doc.title, searchQuery)}</div>
                                <div class="search-result-desc">${highlightText(doc.desc, searchQuery)}</div>
                                <div class="search-result-meta">
                                    <span><img src="icon/文件夹.svg" style="width: 12px; height: 12px;" alt="文件夹"> ${doc.category}</span>
                                    <span><img src="icon/日历.svg" style="width: 12px; height: 12px;" alt="日历"> ${doc.updateTime}</span>
                                    <span><img src="icon/秒表.svg" style="width: 12px; height: 12px;" alt="秒表"> ${doc.readTime}</span>
                                </div>
                            </div>
                        `;
                    });
                }

                if (!hasResults) {
                    html = `
                        <div class="search-empty">
                            <p>没有找到相关结果</p>
                        </div>
                    `;
                }
            } else {
                // Show specific category
                const categoryResults = results[currentSearchTab] || [];
                
                if (categoryResults.length === 0) {
                    html = `
                        <div class="search-empty">
                            <p>该分类下没有找到相关结果</p>
                        </div>
                    `;
                } else {
                    categoryResults.forEach(item => {
                        if (currentSearchTab === 'tools') {
                            html += `
                                <div class="search-tool-card">
                                    <div class="search-tool-logo">
                                        <img src="${item.logo}" alt="${item.name}">
                                    </div>
                                    <div class="search-tool-info">
                                        <div class="search-tool-name">${highlightText(item.name, searchQuery)}</div>
                                        <div class="search-tool-desc">${highlightText(item.desc, searchQuery)}</div>
                                    </div>
                                    <div class="search-tool-badge">${item.badge}</div>
                                </div>
                            `;
                        } else if (currentSearchTab === 'forum') {
                            html += `
                                <div class="search-result-item">
                                    <div class="search-result-title">${highlightText(item.title, searchQuery)}</div>
                                    <div class="search-result-desc">${highlightText(item.desc, searchQuery)}</div>
                                    <div class="search-result-meta">
                                        <span><img src="icon/用户.svg" style="width: 12px; height: 12px;" alt="用户"> ${item.author}</span>
                                        <span><img src="icon/时间.svg" style="width: 12px; height: 12px;" alt="时间"> ${item.time}</span>
                                        <span><img src="icon/评论.svg" style="width: 12px; height: 12px;" alt="评论"> ${item.replies}回复</span>
                                        <span><img src="icon/心形.svg" style="width: 12px; height: 12px;" alt="赞"> ${item.likes}赞</span>
                                    </div>
                                </div>
                            `;
                        } else if (currentSearchTab === 'news') {
                            html += `
                                <div class="search-result-item">
                                    <div class="search-result-title">${highlightText(item.title, searchQuery)}</div>
                                    <div class="search-result-desc">${highlightText(item.desc, searchQuery)}</div>
                                    <div class="search-result-meta">
                                        <span><img src="icon/作者.svg" style="width: 12px; height: 12px;" alt="作者"> ${item.author}</span>
                                        <span><img src="icon/时间.svg" style="width: 12px; height: 12px;" alt="时间"> ${item.time}</span>
                                        <span><img src="icon/浏览.png" style="width: 12px; height: 12px;" alt="浏览"> ${item.views}阅读</span>
                                    </div>
                                </div>
                            `;
                        } else if (currentSearchTab === 'docs') {
                            html += `
                                <div class="search-result-item">
                                    <div class="search-result-title">${highlightText(item.title, searchQuery)}</div>
                                    <div class="search-result-desc">${highlightText(item.desc, searchQuery)}</div>
                                    <div class="search-result-meta">
                                        <span><img src="icon/文件夹.svg" style="width: 12px; height: 12px;" alt="文件夹"> ${item.category}</span>
                                        <span><img src="icon/日历.svg" style="width: 12px; height: 12px;" alt="日历"> ${item.updateTime}</span>
                                        <span><img src="icon/秒表.svg" style="width: 12px; height: 12px;" alt="秒表"> ${item.readTime}</span>
                                    </div>
                                </div>
                            `;
                        }
                    });
                }
            }

            resultsContainer.innerHTML = html;
        }

        // Update result counts
        function updateCounts(results) {
            const total = Object.values(results).reduce((sum, arr) => sum + (arr ? arr.length : 0), 0);
            document.getElementById('count-all').textContent = total;
            document.getElementById('count-news').textContent = results.news ? results.news.length : 0;
            document.getElementById('count-forum').textContent = results.forum ? results.forum.length : 0;
            document.getElementById('count-tools').textContent = results.tools ? results.tools.length : 0;
            document.getElementById('count-docs').textContent = results.docs ? results.docs.length : 0;
        }

        // Search input event
        document.addEventListener('DOMContentLoaded', () => {
            // Connect header search input to open overlay
            const headerSearchInput = document.querySelector('.search-input');
            if (headerSearchInput) {
                headerSearchInput.addEventListener('focus', openSearch);
            }

            // Global search input
            const globalSearchInput = document.getElementById('globalSearchInput');
            if (globalSearchInput) {
                globalSearchInput.addEventListener('input', (e) => {
                    searchQuery = e.target.value;
                    updateSearchResults();
                });
            }

            // Close on ESC key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeSearch();
                }
            });

            // Close on overlay click
            const overlay = document.getElementById('searchOverlay');
            if (overlay) {
                overlay.addEventListener('click', (e) => {
                    if (e.target === overlay) {
                        closeSearch();
                    }
                });
            }
        });

        // ========== 登录注册功能 ==========
        
        // 显示登录模态框
        window.showLoginModal = function() {
            document.getElementById('authModal').style.display = 'flex';
            switchToLogin();
        }

        // 显示注册模态框
        window.showRegisterModal = function() {
            document.getElementById('authModal').style.display = 'flex';
            switchToRegister();
        }

        // 关闭模态框
        window.closeAuthModal = function() {
            document.getElementById('authModal').style.display = 'none';
        }

        // 切换到登录表单
        window.switchToLogin = function() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('registerForm').style.display = 'none';
            document.getElementById('authModalTitle').textContent = '登录';
        }

        // 切换到注册表单
        window.switchToRegister = function() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registerForm').style.display = 'block';
            document.getElementById('authModalTitle').textContent = '注册';
        }

        // 登录注册表单事件监听
        setTimeout(() => {
            // 登录表单提交
            document.getElementById('loginForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const username = document.getElementById('loginUsername').value;
                const password = document.getElementById('loginPassword').value;
                
                try {
                    await apiService.login(username, password);
                    closeAuthModal();
                    location.reload();
                } catch (error) {
                    alert('登录失败: ' + error.message);
                }
            });

            // 注册表单提交
            document.getElementById('registerForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const username = document.getElementById('registerUsername').value;
                const email = document.getElementById('registerEmail').value;
                const fullName = document.getElementById('registerFullName').value;
                const department = document.getElementById('registerDepartment').value;
                const password = document.getElementById('registerPassword').value;
                const confirmPassword = document.getElementById('registerConfirmPassword').value;
                
                if (password !== confirmPassword) {
                    alert('两次输入的密码不一致');
                    return;
                }
                
                try {
                    const [firstName, ...lastNameParts] = fullName.split(' ');
                    const lastName = lastNameParts.join(' ');
                    
                    const registerData = {
                        username,
                        email,
                        password,
                        first_name: firstName,
                        last_name: lastName,
                        department
                    };
                    
                    await apiService.register(registerData);
                    alert('注册成功！请登录');
                    switchToLogin();
                } catch (error) {
                    alert('注册失败: ' + error.message);
                }
            });

            // 点击模态框背景关闭
            document.getElementById('authModal').addEventListener('click', (e) => {
                if (e.target.id === 'authModal') {
                    closeAuthModal();
                }
            });
        }, 100);

        // 添加logout函数
        function logout() {
            alert('正在退出登录...');
            // 实际应用中这里会处理退出登录逻辑
        }
    </script>
    
</body>
</html>